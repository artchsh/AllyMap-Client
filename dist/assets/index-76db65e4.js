import{j as e,a as t,d as Pe,b as at,c as Be,e as it,F as L,f as je,h as ke,i as rt,k as st,l as ot,m as lt,r as re,n as ct,y as Re,o as dt,p as se,A as ee,T as N,I as oe,q as ut,s as We,D as _e,t as Te,u as Oe,v as Ne,S as mt,w as R,x as Me,L as K,z as ze,B as G,C as Fe,E as Q,G as Le,H as Ve,J as He,K as $e,M as Xe,N as Ge,O as E,P as ht,Q as Ke,R as Z,U as Ue,V as ie,W as Se,X as ft,Y as pt,Z as gt,_ as qe,$ as yt,a0 as me,a1 as he,a2 as Qe,a3 as le,a4 as fe,a5 as xt,a6 as bt,a7 as vt,a8 as Ct,a9 as wt}from"./mui-85ae4ebf.js";import{h as ue,l as z,m as D,u as V,o as te,I as pe,O as Ye,r,p as Y,q as ne,s as Je,t as It,v as St,L as Ze,n as kt,w as T,x as Rt,A as Nt,y as Ee,z as Lt,B as _t}from"./vendor-24471450.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function d(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerpolicy&&(l.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?l.credentials="include":i.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=d(i);fetch(i.href,l)}})();let $t=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;const S=ue.create({headers:{Authorization:$t}}),F={style:{background:"#302d38",color:"#ffffff"},className:"text-white rounded-xl",position:"bottom-left"},h={custom:{error:n=>{z.error(n,F)},success:n=>{z.success(n,F)},promise:n=>{z.promise(n,{loading:"Загрузка...",success:"Успешно загружено!",error:"Произошла ошибка"},F)}},login:{success:()=>{z.success("Вы успешно вошли!",F)},invalid:()=>{z.error("Неправильный логин или пароль.",F)}},register:{success:()=>{z.success("Вы успешно зарегистрировались!",F)},invalid:()=>{z.error("Такой логин уже существует",F)}},server:{internalError:()=>{z.error("Что-то пошло не так",F)}}},w={baseURL:"https://hammerhead-app-q63fx.ondigitalocean.app"},qt="639f32ed1e7c8b26f1bceaac",b={1:"#1c1b1f",2:"#25232a",3:"#2b2831",4:"#49454f",5:"#4a4458",6:"#cac4d0",7:"#d0bcff",8:"#e8def8",9:"#302d38",10:"#6a6571",11:"#E6E1E5",12:"#938F99"},Dt=[["Главная","/"],["Запросы","/request"],["Профиль","/settings"]],Ut=["/","/request","/settings"];function Et(){const[n,c]=D.useState([]),[d,o]=D.useState(0),[i,l]=D.useState(0),u=V(),p=te()();p==null&&u("/login");const g=n.includes(p._id);function a(){S.get(`${w.baseURL}/config/`).then(y=>{if(y.data.err)h.custom.error(y.data.err);else{let v=y.data.admins;c(v)}})}function s(y,v){return y==v?{backgroundColor:b[5]}:{}}function f(y,v){return y==v?"rounded-2xl px-3 transition ease-in-out":"rounded-2xl px-3 transition ease-in-out bg-none"}return D.useEffect(()=>{a(),o(Ut.indexOf(location.pathname))},[i]),e("header",{className:"fixed bottom-0 left-0 right-0 w-screen z-50 backdrop-blur",style:{height:76,backgroundColor:b[3]+"ef"},children:t("div",{className:"flex flex-row items-center justify-around h-full",children:[Dt.map((y,v)=>e("button",{onClick:()=>{u(y[1]),l(i+1)},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:s(v,d),className:f(v,d),children:[v==0&&e(Pe,{}),v==1&&e(at,{}),v==2&&e(Be,{})]}),e("label",{children:y[0]})]})},v)),g&&e("button",{onClick:()=>{u("/admin"),l(i+1)},children:t("div",{className:"flex flex-col justify-center items-center",children:[e("div",{style:s(3,d),className:f(3,d),children:e(it,{})}),e("label",{children:"Админ"})]})})]})})}function At(){return t(L,{children:[e(pe,{containerStyle:{marginBottom:76}}),e(Et,{}),e("main",{children:e(Ye,{})})]})}const Pt=[["Comments","/admin/comments"],["Users","/admin/user-control"],["Institutions","/admin/institution-control"],["Requests","/admin/request-institution-control"]],Bt=[["Main","/admin"],["Settings","/admin/settings"],["Home","/"]],jt=["/admin/comments","/admin/user-control","/admin/institution-control","/admin/request-institution-control"],Wt=["/admin","/admin/settings","/"];function Tt(){const[n,c]=r.useState(0),[d,o]=r.useState(0),i=V(),u=te()();function m(){S.get(`${w.baseURL}/config/`).then(a=>{a.data.err?h.custom.error(a.data.err):a.data.admins.includes(u._id)||i("/")})}function p(a,s){return a==s?{backgroundColor:b[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}function g(a,s){return a==s?{backgroundColor:b[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}return r.useEffect(()=>{m(),c(jt.indexOf(location.pathname)),o(Wt.indexOf(location.pathname))},[]),t(L,{children:[e("div",{className:"fixed top-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:b[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:Pt.map((a,s)=>e("button",{onClick:()=>{i(a[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:p(s,n),children:[s==0&&e(je,{}),s==1&&e(Be,{}),s==2&&e(ke,{}),s==3&&e(rt,{})]}),e("label",{children:a[0]})]})},s))})}),e("div",{className:"fixed bottom-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:b[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:Bt.map((a,s)=>e("button",{onClick:()=>{i(a[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:g(s,d),children:[s==0&&e(Pe,{}),s==1&&e(st,{}),s==2&&e(ot,{})]}),e("label",{children:a[0]})]})},s))})})]})}function Ot(n){return t(L,{children:[e(pe,{}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(Tt,{}),t("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"80vh",width:"100%",flexWrap:"wrap",marginTop:76},children:[e(Ye,{}),e("div",{style:{width:1,height:1,marginTop:76}})]})]})]})}function Mt({userID:n,rate:c,comment:d}){const[o,i]=r.useState("");function l(){let u={query:{_id:n}};S.post(`${w.baseURL}/users/find`,u).then(m=>{m.data.err?h.custom.error(m.data.err):i(m.data.login)})}return r.useEffect(()=>{l()},[]),t(L,{children:[e("div",{className:"flex",children:e(G,{primary:o+` - ${c}`,secondary:d})}),e(Fe,{})]})}function zt({comments:n,id:c}){return t("div",{style:{width:"100%",maxWidth:"500px",overflowY:"scroll"},className:"h-full",children:[n.map(({rate:d,userID:o,institutionID:i,content:l},u)=>i==c&&e(Mt,{userID:o,rate:d,comment:l},u)),e("div",{className:"mt-3",style:{height:1,width:1}})]})}function Ft({userID:n,id:c,name:d,address:o,status:i,description:l,link:u,imagePath:m,city:p}){const[g,a]=r.useState(!1),[s,f]=r.useState(""),[y,v]=r.useState(""),[x,q]=r.useState([]),[I,A]=r.useState(!1),[j,H]=r.useState(5),[$,k]=r.useState(""),[P,O]=r.useState(!1),[X,_]=r.useState(1),[M,J]=r.useState(!1),[ce,de]=r.useState("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeIn"),[C,W]=r.useState("relative flex flex-col items-center h-full w-full animate__animated animate__slideInUp"),ge=B=>{let ae=B.target;H(parseInt(ae.value))},ye=B=>{k(B.target.value)};n==null&&(localStorage.removeItem("token"),location.reload());function xe(){_(X+1)}function be(){A(!0),$!=""?S.post(`${w.baseURL}/comments/add`,{userID:n,institutionID:c,content:$,rate:j}).then(B=>{B.data.err?h.custom.error(B.data.err):(a(!1),A(!1),h.custom.success("Вы успешно оставили свою оценку! Спасибо Вам!"),xe())}):(O(!0),A(!1))}function ve(){S.post(`${w.baseURL}/comments/get`,{query:{institutionID:c}}).then(B=>{if(B.data.err)h.custom.error(B.data.err);else{let ae=B.data;q(ae);let we=0,De=0;for(let Ie=0;Ie<ae.length;Ie++){let nt=ae[Ie].rate;we=we+parseInt(nt),De++}let U=Math.ceil(we/De*10)/10;U>0||(U=5),U>=8?(f(U.toString()),v(se[800])):U>=6?(f(U.toString()),v(se[400])):U>=4?(f(U.toString()),v(Re[800])):U>=2?(f(U.toString()),v(re[300])):U>=0?(f(U.toString()),v(re[800])):(f("X"),v(ze[50]))}})}function et(){setTimeout(()=>{J(!1),de("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeIn"),W("relative flex flex-col items-center h-full w-full animate__animated animate__slideInUp")},1e3),de("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeOut"),W("relative flex flex-col items-center h-full w-full animate__animated animate__slideOutDown")}const tt=[{value:0,label:e(lt,{sx:{color:re[500]}})},{value:5,label:e(ct,{sx:{color:Re[400]}})},{value:10,label:e(dt,{sx:{color:se[300]}})}];r.useEffect(()=>{ve()},[X]);let Ce={display:"none",zIndex:500,backgroundColor:"rgb(0,0,0,0.5)"};return M?Ce.display="block":Ce.display="none",t(L,{children:[t(Y.div,{className:"my-1 mx-2 rounded-2xl w-full",style:{backgroundColor:b[2],maxWidth:"500px"},initial:{opacity:0},animate:{opacity:1},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(ee,{sx:{bgcolor:y},children:s})}),t("div",{className:"flex flex-col ml-4",children:[e("h4",{className:"",style:{color:b[11]},children:d}),e("p",{style:{color:b[11]},children:i[1]})]})]}),m!=null&&m!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:m,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",p,", ",o]}),e(N,{variant:"body2",color:"text.secondary",children:l})]}),t("div",{className:"flex justify-between mt-7 flex-row px-4 pb-4",children:[t("div",{className:"flex flex-row",children:[t(oe,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginRight:1,border:1},onClick:()=>{a(!0)},children:[e(ut,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Оценить"})]}),t(oe,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",border:1},onClick:()=>{window.open(u,"_blank")},children:[e(We,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})]}),e("div",{children:e(oe,{onClick:()=>{J(!0)},children:e(je,{})})})]})]},`${c}`),M&&e("div",{className:ce,style:Ce,children:t("div",{className:C,children:[e("div",{onClick:et,className:"h-1/3 w-full"}),t("div",{style:{backgroundColor:b[2],zIndex:1e3},className:"h-2/3 absolute bottom-0 w-11/12 p-4 rounded-t-2xl",children:[e("h1",{className:"text-xl",children:"Комментарии"}),e(zt,{comments:x,id:c})]})]})}),t(_e,{open:g,onClose:()=>{a(!1)},className:"animate__animated animate__fadeIn",children:[e(Te,{children:"Оценка"}),t(Oe,{children:[e(Ne,{children:"Пожалуйста, оцените отношение к представителям LGBTQIA в данном заведении"}),e(mt,{"aria-label":"Always visible",defaultValue:5,onChange:ge,step:1,marks:tt,valueLabelDisplay:"on",min:0,max:10}),e(Ne,{sx:{marginBottom:1},children:"Оставьте комментарий:"}),e(R,{error:P,variant:"outlined",multiline:!0,fullWidth:!0,minRows:3,onChange:ye,onClick:()=>{O(!1)},required:!0})]}),e(Me,{sx:{marginRight:2,marginBottom:2,bgColor:b[2]},children:e(K,{variant:"outlined",loading:I,onClick:()=>{A(!0),be()},sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px"},children:"Оценить"})})]})]})}const Vt=Q("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:15,height:55,backgroundColor:b[9],"&:hover":{backgroundColor:Le(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),Ht=Q("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:b[6]})),Xt=Q(Ve)(({theme:n})=>({color:b[6],"& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%",height:"100%",display:"flex",alignItems:"center"},height:"100%"})),Gt=["Алматы","Астана","Шымкент"];function Kt(){const n=ne(),c=V(),o=te()()||{},i=Je(),l=It(),[u,m]=r.useState([]),[p,g]=r.useState(""),[a,s]=r.useState("");function f(x){g(x.target.value)}function y(){h.custom.promise(S.post(`${w.baseURL}/institutions/find`,{}).then(x=>{x.data.err?h.custom.error(x.data.err):m(x.data)}))}function v(){const x=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;l()==x||i()}return r.useEffect(()=>{n()?(y(),v()):c("/login")},[]),t(L,{children:[t(Y.div,{className:"flex justify-center items-center flex-row mx-2 mb-1",initial:{opacity:0},animate:{opacity:1},children:[t(Vt,{className:"mr-2",children:[e(Ht,{children:e(He,{})}),e(Xt,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:f,sx:{width:"100%"}})]}),e($e,{options:Gt,onInputChange:(x,q)=>{s(q)},className:"mt-3 w-full rounded-3xl",renderInput:x=>e(R,{variant:"outlined",...x,label:"Город"})})]}),e("div",{className:"flex justify-center flex-wrap",children:u.map((x,q)=>{var I;return((I=x==null?void 0:x.city)==null?void 0:I.includes(a))&&(x==null?void 0:x.title.includes(p))&&e(Ft,{imagePath:x.imagePath,name:x.title,status:x.status,description:x.description,address:x.address,id:x._id,link:x.link,userID:o._id,city:x.city},q)})})]})}function Qt(){const n=V(),c=St(),d=ne(),[o,i]=D.useState(""),[l,u]=D.useState(""),m=a=>{u(a.target.value)},p=a=>{i(a.target.value)},g=()=>{ue.post(`${w.baseURL}/users/login`,{login:o,password:l}).then(a=>{if(!a.data.err)c({token:a.data.token,expiresIn:a.data.expiresIn,tokenType:"Bearer",authState:a.data.docs})?(location.reload(),h.login.success()):h.server.internalError();else{const s=a.data.err;h.custom.error(s)}}).catch(a=>{h.custom.error("Слишком часто! Попробуйте еще раз через 5 минут")})};return D.useEffect(()=>{d()&&n("/"),window.addEventListener("keypress",function(a){a.key==="Enter"&&(a.preventDefault(),document.getElementById("loginbtn").click())})},[]),t(L,{children:[e(pe,{}),e(Y.div,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},initial:{opacity:0},animate:{opacity:1},children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Вход"}),t("p",{className:"text-sm",children:["Или ",e(Ze,{className:"",style:{color:b[7]},to:"/register",children:"создать новый аккаунт"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Xe,{className:"mr-2"}),e(R,{label:"Логин",variant:"outlined",onChange:p})]}),t("div",{className:"flex flex-end items-center mb-4",children:[e(Ge,{className:"mr-2"}),e(R,{label:"Пароль",variant:"outlined",type:"password",onChange:m})]}),e(E,{id:"loginbtn",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},onClick:g,children:"Войти"})]})})]})}function Yt(){const n=V(),c=ne(),[d,o]=D.useState(""),[i,l]=D.useState(""),[u,m]=D.useState(""),[p,g]=D.useState(!1),a=I=>{l(I.target.value),g(!1)},s=I=>{o(I.target.value),g(!1)},f=I=>{m(I.target.value),g(!1)},y=()=>{if(d==""||i==""||u=="")return h.custom.error("Заполните все поля"),g(!0),null;ue.post(`${w.baseURL}/users/register`,{login:d,password:i,inviteCode:u}).then(I=>(I.data.err?h.custom.error(I.data.err):n("/login"),null)).catch(I=>{h.custom.error("Слишком часто! Попробуйте еще раз через 5 минут")})};function v(){ue.post(`${w.baseURL}/users/find`,{query:{login:d}}).then(I=>{I.data.err?h.custom.success("Этот логин можно использовать"):I.data.login==d&&(h.custom.error("Такой логин уже существует"),g(!0))})}function x(){(i.length<7||i=="")&&(h.custom.error("Пароль слишком короткий"),g(!0))}function q(){(u.length!=8||u=="")&&(h.custom.error("Неверный инвайт-код"),g(!0))}return D.useEffect(()=>{c()&&n("/")},[]),t(L,{children:[e(pe,{}),e(Y.div,{className:"flex justify-center items-center h-screen flex-col",initial:{opacity:0},animate:{opacity:1},children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Регистрация"}),t("p",{className:"text-sm",children:["Уже есть аккаунт? ",e(Ze,{className:"",style:{color:b[7]},to:"/login",children:"Войти"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Xe,{className:"mr-2"}),e(R,{label:"Логин",variant:"outlined",onChange:s,onBlur:v})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ge,{className:"mr-2"}),e(R,{label:"Пароль",variant:"outlined",type:"password",onChange:a,onBlur:x})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(ht,{className:"mr-2"}),e(R,{label:"Инвайт-код",variant:"outlined",onChange:f,onBlur:q})]}),e("div",{className:"flex justify-center items-center",style:{marginTop:12},children:e(E,{onClick:y,sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},variant:"outlined",fullWidth:!0,disabled:p,children:"Зарегистрироваться"})})]})})]})}const Jt="/assets/patreon-app-icon-2b2458e8.png",Zt="/assets/author_picture-2c0ee235.png",Ae=kt.a`
    text-decoration: none;
    color: white;
`;function en(){const n=te(),c=Je(),d=n()||{},[o,i]=r.useState(""),[l,u]=r.useState(0),[m,p]=r.useState(0);function g(){S.post(`${w.baseURL}/institutions/find`).then(a=>{if(a.data.err)h.custom.error(a.data.err);else{let s=[];a.data.map(y=>{y.userID==d._id&&s.push(y)}),u(s.length)}}),S.post(`${w.baseURL}/institutions/request/find`).then(a=>{if(a.data.err)h.custom.error(a.data.err);else{let s=[];a.data.map(y=>{y.userRequestID==d._id&&s.push(y)}),p(s.length)}})}return r.useEffect(()=>{i(d.inviteCode),g()},[]),e(Y.div,{className:"flex justify-center w-full",initial:{opacity:0},animate:{opacity:1},children:t("div",{className:"max-w-xl",children:[t(Ke,{children:[e(Z,{disablePadding:!0,children:t(Ue,{onClick:()=>{window.open("https://www.patreon.com/charlzWeb/membership","_blank")},children:[e(ie,{children:e(ee,{src:Jt})}),e(G,{primary:"Patreon",secondary:"Поддержать проект"})]})}),t(Z,{children:[e(Se,{children:e(ie,{children:e(ft,{})})}),e(G,{primary:o,secondary:"Инвайт-код для друга"})]}),t(Z,{children:[e(Se,{children:e(ie,{children:e(ke,{})})}),e(G,{primary:l,secondary:"Количество одобренных заведений"})]}),t(Z,{children:[e(Se,{children:e(ie,{children:e(ke,{})})}),e(G,{primary:m,secondary:"Количество заведений в рассмотрении"})]}),e(Z,{disablePadding:!0,children:t(Ue,{onClick:()=>{c()},sx:{color:"#eb4034"},children:[e(ie,{children:e(pt,{color:"error"})}),e(G,{primary:"Выйти из аккаунта"})]})})]}),e("div",{className:"flex justify-center items-center mt-5",style:{marginBottom:76},children:e(gt,{elevation:0,sx:{background:"none"},children:t("div",{style:{display:"flex",flexDirection:"column"},children:[t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(ee,{src:Zt}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Ae,{href:"https://github.com/bogdanshelest",target:"_blank",children:"Charlz"}),e(N,{variant:"body2",color:"text.secondary",children:"Разработчик и автор проекта"})]})]}),t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(ee,{children:"S"}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Ae,{target:"_blank",children:"Senrik_miele"}),e(N,{variant:"body2",color:"text.secondary",children:"Помощник и тестер сайта"})]})]})]})})})]})})}function tn({name:n,address:c,description:d,link:o,imagePath:i,city:l}){return t(Y.div,{className:"my-1 rounded-2xl w-full",style:{backgroundColor:b[2],width:"95vw"},initial:{opacity:0},animate:{opacity:1},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(ee,{children:n[0]})}),e("div",{className:"flex flex-col ml-4",children:e("h4",{className:"",style:{color:b[11]},children:n})})]}),i!=null&&i!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:i,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",l,", ",c]}),e(N,{variant:"body2",color:"text.secondary",children:d})]}),e("div",{className:"flex flex-start mt-7 flex-row px-4 pb-4",children:e("div",{className:"flex flex-row",children:t(oe,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center",border:1},onClick:()=>{window.open(o,"_blank")},children:[e(We,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})})})]})}const nn=T.div`
	display: flex;
	justify-content: center;
	flex-wrap: wrap;
	flex-direction: column;
`,an=T.div`
	width: 1px;
	height: 1px;
	margin-bottom: 100px;
`,rn=T.div`
	display:flex;
	justify-content: center;
	align-items: center;
`,sn=[{label:"Алматы"},{label:"Астана"},{label:"Шымкент"}];function on(){const n=ne(),c=te(),d=V(),o=c()||{},[i,l]=r.useState(void 0),[u,m]=r.useState(""),[p,g]=r.useState(""),[a,s]=r.useState(""),[f,y]=r.useState(""),[v,x]=r.useState(""),[q,I]=r.useState(!1),[A,j]=r.useState(!1),[H,$]=r.useState([]),k=C=>{m(C.target.value)},P=C=>{g(C.target.value)},O=C=>{s(C.target.value)},X=C=>{y(C.target.value)},_=()=>{j(!1),window.location.reload()};async function M(){h.custom.promise(S.post(`${w.baseURL}/institutions/request/find`,{query:{}}).then(C=>{C.data.err?h.custom.error(C.data.err):$(C.data)}))}const J=async()=>{if(de()){I(!0);const C=new FormData;C.append("title",u),C.append("description",p),C.append("link",a),C.append("address",f),C.append("userRequestID",o._id),C.append("image",i),C.append("city",v),S.post(`${w.baseURL}/institutions/request/new`,C,{headers:{"Content-Type":"multipart/form-data"}}).then(W=>{W.data.err?(j(!1),I(!1),h.custom.error(W.data.err)):(j(!0),I(!1))}),I(!1)}};function ce(){return i==null?"":URL.createObjectURL(i)}function de(){return u==""||p==""||v==""||f==""||a==""?(h.custom.error("Заполните все поля!"),!1):a.includes("https")||a.includes("http")?!0:(h.custom.error("Неверная ссылка"),!1)}return r.useEffect(()=>{n()?M():d("/login")},[]),t(L,{children:[t(_e,{open:A,onClose:_,children:[e(Oe,{children:e(Ne,{children:"Вы отправили свой запрос на добавление нового заведения в список. В течении некоторого времени, модераторы рассмотрят ваш запрос"})}),e(Me,{children:e(E,{onClick:_,autoFocus:!0,children:"ОК"})})]}),e(Y.div,{style:{display:"flex",justifyContent:"center",flexDirection:"column"},initial:{opacity:0},animate:{opacity:1},children:t("div",{className:"mb-1 mt-2 mx-2 rounded-2xl",style:{backgroundColor:b[2],maxWidth:"500px"},children:[t("div",{children:[e("p",{className:"ml-1 pt-4 px-4",children:"Запрос на добавление заведения"}),ce()&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:ce(),className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t(qe,{sx:{display:"flex",flexDirection:"column"},className:"mt-2 px-4",children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-title",label:"Название",placeholder:'Ресторан "Открытый"',onChange:k}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-description",label:"Описание",multiline:!0,placeholder:"Очень крутое заведение...",onChange:P}),e($e,{disablePortal:!0,options:sn,onInputChange:(C,W)=>{x(W)},fullWidth:!0,className:"mt-3 w-full",renderInput:C=>t(L,{children:[" ",e(R,{InputLabelProps:{shrink:!0},required:!0,...C,label:"Город"})," "]})}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-address",label:"Адрес",placeholder:"Мкр. Алтын 77",onChange:X}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",id:"input-link",placeholder:"https://...",required:!0,label:"Ссылка на метку в карте/сайт заведения",onChange:O})]})]}),e("div",{className:"flex justify-between mt-3 flex-row px-4 pb-4",children:t("div",{className:"flex flex-row",children:[e(K,{loading:q,onClick:J,variant:"outlined",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center"},loadingIndicator:"Загрузка...",children:"Запросить"}),t(E,{variant:"outlined",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginLeft:1,border:1},className:"flex justify-center items-center",component:"label",children:[e(yt,{sx:{marginRight:.3}}),e("p",{className:"text-xs w-min mr-1",children:"Добавить изображение "}),e("input",{type:"file",accept:"image/png, image/jpeg, image/jpg","data-filename":i,onChange:C=>{l(C.target.files[0])},hidden:!0})]})]})})]})}),e(nn,{children:H.map(({title:C,address:W,description:ge,link:ye,imagePath:xe,city:be},ve)=>e(rn,{children:e(tn,{name:C,address:W,description:ge,link:ye,imagePath:xe,city:be})},ve))}),e(an,{})]})}function ln({id:n,name:c,address:d,description:o,link:i,imagePath:l,userID:u}){const[m,p]=r.useState(!1);function g(){p(!0),S.post(`${w.baseURL}/institutions/request/accept`,{query:{_id:n}}).then(s=>{s.data.err?h.custom.error(s.data.err):window.location.reload()})}function a(){p(!0),S.post(`${w.baseURL}/institutions/request/decline`,{query:{_id:n}}).then(s=>{s.data.err?h.custom.error(s.data.err):window.location.reload()})}return r.useEffect(()=>{p(!1)},[]),t(me,{sx:{width:"95vw",maxWidth:500},square:!0,children:[e(he,{title:c,subheader:`ID пользователя: ${u}`}),l!=null&&l!=""&&e(Qe,{component:"img",height:"240",image:l}),t(le,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",d]}),e(N,{variant:"body2",color:"text.secondary",children:o})]}),t(fe,{children:[e(K,{size:"small",variant:"contained",onClick:()=>{window.open(i,"_blank")},children:"ССЫЛКА"}),t(L,{children:[e(K,{color:"success",size:"small",variant:"contained",loading:m,onClick:()=>{g()},children:"Принять"}),e(K,{color:"error",size:"small",variant:"contained",loading:m,onClick:()=>{a()},children:"Отклонить"})]})]})]})}const cn=T.div`
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 100px;
`,dn=T.div`
    display:flex;
    justify-content: center;
    align-items: center;
    margin: 10px;
    width: fit-content;
`;function un(){const n=ne(),c=V(),[d,o]=r.useState([]);async function i(){S.post(`${w.baseURL}/institutions/request/find`,{query:{}}).then(l=>{l.data.err?h.custom.error(l.data.err):o(l.data)})}return r.useEffect(()=>{n()?i():c("/login")},[]),e(L,{children:e(cn,{children:d.map(({_id:l,title:u,address:m,description:p,link:g,imagePath:a,userRequestID:s},f)=>e(dn,{children:e(ln,{id:l,name:u,address:m,description:p,link:g,imagePath:a,userID:s})},f))})})}const mn=Q(n=>{const{expand:c,...d}=n;return e(oe,{...d})})(({theme:n,expand:c})=>({transform:c?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})})),hn=["Алматы","Астана","Шымкент"];function fn(n){const{open:c,institutionID:d,institutionTitle:o}=n,[i,l]=r.useState(""),[u,m]=r.useState(""),[p,g]=r.useState(""),[a,s]=r.useState(""),[f,y]=r.useState(""),[v,x]=r.useState(""),[q,I]=r.useState(!0);function A(){S.post(`${w.baseURL}/institutions/find`,{query:{_id:d}}).then($=>{if($.data.err)h.custom.error($.data.err);else{const k=$.data[0];l(k.title),m(k.description),s(k.address),y(k.link),x(k.imagePath),g(k.city)}})}function j($){$.preventDefault();const k=new FormData($.currentTarget);S.post(`${w.baseURL}/institutions/edit`,{query:{_id:d},updated:{title:k.get("title"),description:k.get("description"),address:k.get("address"),link:k.get("link"),imagePath:k.get("imagePath")}}).then(P=>{P.data.err?h.custom.error(P.data.err):window.location.reload()})}function H(){document.getElementById("title").value=i,document.getElementById("description").value=u,document.getElementById("address").value=a,document.getElementById("link").value=f,document.getElementById("imagePath").value=v,document.getElementById("imagePath").value=p,I(!1)}return r.useEffect(()=>{A()},[]),t(_e,{open:c,children:[t(Te,{children:["Реадактировать заведение ",o]}),t(qe,{component:"form",noValidate:!0,onSubmit:j,sx:{margin:1},children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"title",label:"Название заведения",name:"title"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"description",label:"Описание",id:"description"}),e($e,{options:hn,onInputChange:($,k)=>{g(k)},className:"mt-3 w-full rounded-3xl",renderInput:$=>e(R,{variant:"outlined",...$,label:"Город",id:"city"})}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"address",label:"Адрес",id:"address"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"link",label:"Ссылка",id:"link"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"imagePath",label:"Путь к картинке",id:"imagePath"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(E,{type:"submit",color:"success",fullWidth:!0,variant:"contained",sx:{mt:2,mb:2,mr:1},disabled:q,children:"Сохранить"}),e(E,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{H()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})]})}function pn({userID:n,rate:c,comment:d}){const[o,i]=r.useState("");function l(){const u={query:{_id:n}};S.post(`${w.baseURL}/users/find`,u).then(m=>{m.data.err?h.custom.error(m.data.err):i(m.data.login)})}return r.useEffect(()=>{l()},[]),t(L,{children:[e(Z,{alignItems:"flex-start",children:e(G,{primary:o+` - ${c}`,secondary:e(D.Fragment,{children:d})})}),e(Fe,{})]})}function gn({comments:n,expanded:c,id:d}){return e(bt,{in:c,timeout:"auto",unmountOnExit:!0,children:t(le,{children:[e(N,{paragraph:!0,children:"Comments:"}),e(Ke,{sx:{width:"100%",maxWidth:"500px"},children:n.map(({rate:o,userID:i,institutionID:l,content:u},m)=>l==d&&e(pn,{userID:i,rate:o,comment:u},m))})]})})}function yn({userID:n,id:c,name:d,address:o,description:i,link:l,imagePath:u}){n==null&&(localStorage.removeItem("token"),location.reload());const[m,p]=r.useState(""),[g,a]=r.useState(""),[s,f]=r.useState([]),[y,v]=r.useState(!1),[x,q]=r.useState(!1),I=()=>{v(!y)};function A(){S.post(`${w.baseURL}/institutions/remove`,{query:{_id:c}}).then(k=>{k.data.err?h.custom.error(k.data.err):window.location.reload()})}function j(){q(!0)}function H(){q(!1)}function $(){S.post(`${w.baseURL}/comments/get`,{query:{institutionID:c}}).then(k=>{if(k.data.err)h.custom.error(k.data.err);else{let P=k.data;f(P);let O=0,X=0;for(let M=0;M<P.length;M++){let J=P[M].rate;O=O+parseInt(J),X++}let _=Math.ceil(O/X*10)/10;_>0||(_=5),_>=8?(p(_.toString()),a(se[800])):_>=6?(p(_.toString()),a(se[400])):_>=4?(p(_.toString()),a(Re[800])):_>=2?(p(_.toString()),a(re[300])):_>=0?(p(_.toString()),a(re[800])):(p("X"),a(ze[50]))}})}return r.useEffect(()=>{$()},[]),t(me,{sx:{width:"95vw",maxWidth:"500px",marginBottom:-1.1},children:[e(fn,{open:x,onClose:H,institutionID:c,institutionTitle:d}),e(he,{title:d,subheader:`ID пользователя: ${n}`,avatar:t(ee,{sx:{bgcolor:g},"aria-label":"recipe",children:[" ",m," "]})}),u!=null&&u!=""&&e(Qe,{component:"img",height:"240",image:u}),t(le,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",o]}),e(N,{variant:"body2",color:"text.secondary",children:i})]}),t(fe,{disableSpacing:!0,children:[e(E,{size:"small",onClick:()=>{window.open(l,"_blank")},children:"ССЫЛКА"}),e(E,{size:"small",onClick:()=>{A()},children:"УДАЛИТЬ"}),e(E,{size:"small",onClick:()=>{j()},children:"РЕАДАКТИРОВАТЬ"}),e(mn,{expand:y,onClick:I,"aria-expanded":y,"aria-label":"show more",children:e(xt,{})})]}),e(gn,{expanded:y,comments:s,id:c})]})}const xn=T.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
`,bn=T.div`
  display:flex;
  justify-content: center;
  align-items: center;
  margin: 10px;
  width: fit-content;
`,vn=Q("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:Le(n.palette.common.white,.15),"&:hover":{backgroundColor:Le(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),Cn=Q("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"})),wn=Q(Ve)(({theme:n})=>({color:"inherit","& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%"}}));function In(){const n=ne(),c=V(),o=te()(),[i,l]=r.useState([]),[u,m]=r.useState("");function p(a){m(a.target.value)}async function g(){S.post(`${w.baseURL}/institutions/find`,{}).then(a=>{a.data.err?h.custom.error(a.data.err):l(a.data)})}return r.useEffect(()=>{n()?g():c("/login")},[]),e(L,{children:t("div",{className:"flex flex-col absolute top-20",children:[e("div",{style:{display:"flex",justifyContent:"center"},children:t(vn,{children:[e(Cn,{children:e(He,{})}),e(wn,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:p})]})}),e(xn,{children:i.map((a,s)=>a.title.includes(u)&&e(bn,{children:e(yn,{imagePath:a.imagePath,name:a.title,status:a.status,description:a.description,address:a.address,id:a._id,link:a.link,userID:o._id})},s))})]})})}function Sn(){return e(L,{})}function kn({id:n,login:c,inviteCode:d,acceptCode:o}){const[i,l]=r.useState(!1);function u(){S.post(`${w.baseURL}/users/remove`,{query:{id:n}}).then(m=>{m.data.err?h.custom.error(m.data.err):location.reload()})}return r.useEffect(()=>{l(!1)},[]),t(me,{sx:{width:"95vw",maxWidth:250},square:!0,children:[e(he,{title:c}),t(le,{children:[t(N,{variant:"body2",color:"text.secondary",children:["ID: ",n]}),t(N,{variant:"body2",color:"text.secondary",children:["Invite Code: ",d]}),t(N,{variant:"body2",color:"text.secondary",children:["Accept Code: ",o]})]}),e(fe,{children:e(K,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:i,onClick:()=>{u()},children:"Удалить"})})]})}const Rn=T.div`
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
`,Nn=T.div`
    display:flex;
    justify-content: center;
    align-items: center;
    margin: 10px;
    width: fit-content;
`;function Ln(){const[n,c]=r.useState([]);async function d(){S.post(`${w.baseURL}/users/find/all`).then(o=>{o.data.err?h.custom.error(o.data.err):c(o.data)})}return r.useEffect(()=>{d()},[]),e(L,{children:e(Rn,{children:n.map(({_id:o,login:i,inviteCode:l,acceptCode:u},m)=>o!=qt&&e(Nn,{children:e(kn,{id:o,login:i,inviteCode:l,acceptCode:u})},m))})})}function _n(){const[n,c]=r.useState(""),[d,o]=r.useState(""),[i,l]=r.useState([]),[u,m]=r.useState(!0);function p(){S.get(`${w.baseURL}/config/`).then(s=>{s.data.err?h.custom.error(s.data.err):(c(s.data.name),o(s.data.version),l(s.data.admins))})}function g(s){s.preventDefault();const f=new FormData(s.currentTarget);let y=f.get("admins").toString().split(",");y.includes("639f32ed1e7c8b26f1bceaac")||y.push("639f32ed1e7c8b26f1bceaac"),S.post(`${w.baseURL}/config/update`,{name:f.get("name"),version:f.get("version"),admins:y}).then(v=>{v.data.err?h.custom.error(v.data.err):location.reload()})}function a(){let s="";for(let f=0;f<i.length;f++)f==i.length-1?s+=i[f]:s+=i[f]+",";document.getElementById("name").value=n,document.getElementById("version").value=d,document.getElementById("admins").value=s,m(!1)}return r.useEffect(()=>{p()},[]),e(L,{children:t(qe,{component:"form",noValidate:!0,onSubmit:g,className:"p-4",children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Имя проекта",name:"name"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"version",label:"Версия",type:"version",id:"version"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"admins",label:"Админы (перечислите ID пользователей через запятые без пробелов)",type:"admins",id:"admins"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(E,{type:"submit",color:"success",fullWidth:!0,variant:"contained",size:"small",sx:{mt:2,mb:2},disabled:u,children:"Сохранить"}),e(E,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{a()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})})}function $n({_id:n,userID:c,institutionID:d,content:o,rate:i}){const[l,u]=r.useState(!1),[m,p]=r.useState("");function g(){S.post(`${w.baseURL}/comments/remove`,{query:{_id:n}}).then(s=>{s.data.err?h.custom.error(s.data.err):window.location.reload()})}function a(){const s={query:{_id:c}};S.post(`${w.baseURL}/users/find`,s).then(f=>{f.data.err?h.custom.error(f.data.err):p(f.data.login)})}return r.useEffect(()=>{u(!1),a()},[]),t(me,{sx:{width:"95vw",maxWidth:250,margin:1},children:[e(he,{title:m}),t(le,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Rate: ",i]}),t(N,{variant:"body2",color:"text.secondary",children:["Comment ID: ",n]}),t(N,{variant:"body2",color:"text.secondary",children:["User ID: ",c]}),t(N,{variant:"body2",color:"text.secondary",children:["Institution ID: ",d]}),t(N,{variant:"body2",color:"text.secondary",children:["Comment Text: ",o]})]}),e(fe,{children:e(K,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:l,onClick:()=>{g()},children:"Удалить"})})]})}function qn(){const[n,c]=r.useState([]);function d(){S.post(`${w.baseURL}/comments/get`,{query:{}}).then(o=>{o.data.err?h.custom.error(o.data.err):c(o.data)})}return r.useEffect(()=>{d()},[]),e(L,{children:n.map((o,i)=>e($n,{_id:o._id,userID:o.userID,institutionID:o.institutionID,content:o.content,rate:o.rate},i))})}function Dn(){const n="/login",d=Rt([{path:"/login",element:e(Qt,{})},{path:"/register",element:e(Yt,{})},{path:"/",element:e(Ee,{loginPath:n,children:e(At,{})}),children:[{index:!0,element:e(Kt,{})},{path:"/request",element:e(on,{})},{path:"/settings",element:e(en,{})}]},{path:"/admin",element:e(Ee,{loginPath:n,children:e(Ot,{})}),children:[{index:!0,element:e(Sn,{})},{path:"/admin/institution-control",element:e(In,{})},{path:"/admin/request-institution-control",element:e(un,{})},{path:"/admin/user-control",element:e(Ln,{})},{path:"/admin/settings",element:e(_n,{})},{path:"/admin/comments",element:e(qn,{})}]}]);return e(Nt,{authType:"localstorage",authName:"_auth",children:d})}const Un=vt({palette:{mode:"dark",primary:{main:"#6750a4"},secondary:{main:"#625b71"}},shape:{borderRadius:15}});Lt.createRoot(document.getElementById("root")).render(e(r.StrictMode,{children:t(Ct,{theme:Un,children:[e(wt,{}),e(_t,{children:e(Dn,{})})]})}));
