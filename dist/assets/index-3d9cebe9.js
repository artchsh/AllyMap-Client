import{j as e,d as it,r as le,a as rt,y as Ne,b as st,c as oe,e as t,F as B,A as te,T as N,I as de,f as lt,h as je,i as We,D as qe,k as Te,l as Me,m as Le,S as ot,n as R,o as ze,L as Y,p as Fe,q as Q,s as Oe,t as Ve,u as dt,v as He,w as ct,x as J,z as _e,B as Xe,C as Ge,E as De,G as Ke,H as Qe,J as A,K as ut,M as Ye,N as ee,O as Ae,P as se,Q as ke,R as mt,U as $e,V as ht,W as ft,X as Ue,Y as gt,Z as fe,_ as ge,$ as Je,a0 as ce,a1 as pe,a2 as pt,a3 as xt,a4 as bt,a5 as yt,a6 as vt,a7 as Ct,a8 as It,a9 as wt}from"./mui-59062634.js";import{h as he,l as V,r,m as U,u as X,o as ne,I as xe,p as ae,q as Ze,s as St,t as Rt,L as et,n as kt,v as G,B as Nt,w as Lt,x as P,y as z,A as _t,z as $t}from"./vendor-e23d16e8.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function c(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(s){if(s.ep)return;s.ep=!0;const o=c(s);fetch(s.href,o)}})();const b={1:"#1c1b1f",2:"#25232a",3:"#2b2831",4:"#49454f",5:"#4a4458",6:"#cac4d0",7:"#d0bcff",8:"#e8def8",9:"#302d38",10:"#6a6571",11:"#E6E1E5",12:"#938F99"},y={baseURL:"https://hammerhead-app-q63fx.ondigitalocean.app"},qt="639f32ed1e7c8b26f1bceaac";let Dt=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;const C=he.create({headers:{Authorization:Dt}}),H={style:{borderRadius:"15px",background:"#302d38",color:"#fff"}},f={custom:{error:n=>{V.error(n,H)},success:n=>{V.success(n,H)},promise:n=>{V.promise(n,{loading:"Загрузка...",success:"Успешно загружено!",error:"Произошла ошибка"},H)}},login:{success:()=>{V.success("Вы успешно вошли!",H)},invalid:()=>{V.error("Неправильный логин или пароль.",H)}},register:{success:()=>{V.success("Вы успешно зарегистрировались!",H)},invalid:()=>{V.error("Такой логин уже существует",H)}},server:{internalError:()=>{V.error("Что-то пошло не так",H)}}};function Ut({userID:n,rate:d,comment:c}){const[l,s]=r.useState("");function o(){let u={query:{_id:n}};C.post(`${y.baseURL}/users/find`,u).then(m=>{m.data.err?f.custom.error(m.data.err):s(m.data.login)})}return r.useEffect(()=>{o()},[]),t(B,{children:[e("div",{className:"flex",children:e(Q,{primary:l+` - ${d}`,secondary:c})}),e(Oe,{})]})}function Et({comments:n,id:d}){return t("div",{style:{width:"100%",maxWidth:"500px",overflowY:"scroll"},className:"h-full",children:[n.map(({rate:c,userID:l,institutionID:s,content:o},u)=>s==d&&e(Ut,{userID:l,rate:c,comment:o},u)),e("div",{className:"mt-3",style:{height:1,width:1}})]})}function Pt({userID:n,id:d,name:c,address:l,status:s,description:o,link:u,imagePath:m,city:p}){const[x,a]=r.useState(!1),[i,h]=r.useState(""),[w,k]=r.useState(""),[E,q]=r.useState([]),[S,g]=r.useState(!1),[$,j]=r.useState(5),[_,I]=r.useState(""),[W,F]=r.useState(!1),[K,L]=r.useState(1),[O,Z]=r.useState(!1),[ue,me]=r.useState("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeIn"),[v,M]=r.useState("relative flex flex-col items-center h-full w-full animate__animated animate__slideInUp"),be=T=>{let re=T.target;j(parseInt(re.value))},ye=T=>{I(T.target.value)};n==null&&(localStorage.removeItem("token"),location.reload());function ve(){L(K+1)}function Ce(){g(!0),_!=""?C.post(`${y.baseURL}/comments/add`,{userID:n,institutionID:d,content:_,rate:$}).then(T=>{T.data.err?f.custom.error(T.data.err):(a(!1),g(!1),f.custom.success("Вы успешно оставили свою оценку! Спасибо Вам!"),ve())}):(F(!0),g(!1))}function Ie(){C.post(`${y.baseURL}/comments/get`,{query:{institutionID:d}}).then(T=>{if(T.data.err)f.custom.error(T.data.err);else{let re=T.data;q(re);let Se=0,Pe=0;for(let Re=0;Re<re.length;Re++){let at=re[Re].rate;Se=Se+parseInt(at),Pe++}let D=Math.ceil(Se/Pe*10)/10;D>0||(D=5),D>=8?(h(D.toString()),k(oe[800])):D>=6?(h(D.toString()),k(oe[400])):D>=4?(h(D.toString()),k(Ne[800])):D>=2?(h(D.toString()),k(le[300])):D>=0?(h(D.toString()),k(le[800])):(h("X"),k(Fe[50]))}})}function tt(){setTimeout(()=>{Z(!1),me("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeIn"),M("relative flex flex-col items-center h-full w-full animate__animated animate__slideInUp")},1e3),me("fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeOut"),M("relative flex flex-col items-center h-full w-full animate__animated animate__slideOutDown")}const nt=[{value:0,label:e(it,{sx:{color:le[500]}})},{value:5,label:e(rt,{sx:{color:Ne[400]}})},{value:10,label:e(st,{sx:{color:oe[300]}})}];r.useEffect(()=>{Ie()},[K]);let we={display:"none",zIndex:500,backgroundColor:"rgb(0,0,0,0.5)"};return O?we.display="block":we.display="none",t(B,{children:[t("div",{className:"my-1 mx-2 rounded-2xl w-full",style:{backgroundColor:b[2],maxWidth:"500px"},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(te,{sx:{bgcolor:w},children:i})}),t("div",{className:"flex flex-col ml-4",children:[e("h4",{className:"",style:{color:b[11]},children:c}),e("p",{style:{color:b[11]},children:s[1]})]})]}),m!=null&&m!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:m,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",p,", ",l]}),e(N,{variant:"body2",color:"text.secondary",children:o})]}),t("div",{className:"flex justify-between mt-7 flex-row px-4 pb-4",children:[t("div",{className:"flex flex-row",children:[t(de,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginRight:1,border:1},onClick:()=>{a(!0)},children:[e(lt,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Оценить"})]}),t(de,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",border:1},onClick:()=>{window.open(u,"_blank")},children:[e(je,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})]}),e("div",{children:e(de,{onClick:()=>{Z(!0)},children:e(We,{})})})]})]}),O&&e("div",{className:ue,style:we,children:t("div",{className:v,children:[e("div",{onClick:tt,className:"h-1/3 w-full"}),t("div",{style:{backgroundColor:b[2],zIndex:1e3},className:"h-2/3 absolute bottom-0 w-11/12 p-4 rounded-t-2xl",children:[e("h1",{className:"text-xl",children:"Комментарии"}),e(Et,{comments:E,id:d})]})]})}),t(qe,{open:x,onClose:()=>{a(!1)},className:"animate__animated animate__fadeIn",children:[e(Te,{children:"Оценка"}),t(Me,{children:[e(Le,{children:"Пожалуйста, оцените отношение к представителям LGBTQIA в данном заведении"}),e(ot,{"aria-label":"Always visible",defaultValue:5,onChange:be,step:1,marks:nt,valueLabelDisplay:"on",min:0,max:10}),e(Le,{sx:{marginBottom:1},children:"Оставьте комментарий:"}),e(R,{error:W,variant:"outlined",multiline:!0,fullWidth:!0,minRows:3,onChange:ye,onClick:()=>{F(!1)},required:!0})]}),e(ze,{sx:{marginRight:2,marginBottom:2,bgColor:b[2]},children:e(Y,{variant:"outlined",loading:S,onClick:()=>{g(!0),Ce()},sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px"},children:"Оценить"})})]})]})}const At=[["Главная","/"],["Запросы","/request"],["Профиль","/settings"]],Bt=["/","/request","/settings"];function jt(n){const[d,c]=U.useState([]),[l,s]=U.useState(0),o=X(),m=ne()(),p=d.includes(m._id);function x(){C.get(`${y.baseURL}/config/`).then(i=>{if(i.data.err)f.custom.error(i.data.err);else{let h=i.data.admins;c(h)}})}function a(i,h){return i==h?{backgroundColor:b[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}return U.useEffect(()=>{x(),s(Bt.indexOf(location.pathname))},[]),t(B,{children:[e("header",{className:"fixed bottom-0 left-0 right-0 w-screen z-50 backdrop-blur",style:{height:76,backgroundColor:b[3]+"ef"},children:t("div",{className:"flex flex-row items-center justify-around h-full",children:[At.map((i,h)=>e("button",{onClick:()=>{o(i[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:a(h,l),children:[h==0&&e(Ve,{}),h==1&&e(dt,{}),h==2&&e(He,{})]}),e("label",{children:i[0]})]})},h)),p&&e("button",{onClick:()=>{o("/admin")},children:t("div",{className:"flex flex-col justify-center items-center",children:[e("div",{style:a(3,l),children:e(ct,{})}),e("label",{children:"Админ"})]})})]})}),n.children]})}function Ee(n){return t(B,{children:[e(xe,{}),e(jt,{}),e("main",{children:n.children})]})}const Wt=J("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:15,height:55,backgroundColor:b[9],"&:hover":{backgroundColor:_e(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),Tt=J("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:b[6]})),Mt=J(Xe)(({theme:n})=>({color:b[6],"& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%",height:"100%",display:"flex",alignItems:"center"},height:"100%"})),zt=["Алматы","Астана","Шымкент"];function Ft(){const n=ae(),d=X(),l=ne()()||{},s=Ze(),o=St(),[u,m]=r.useState([]),[p,x]=r.useState(""),[a,i]=r.useState([]),[h,w]=r.useState("");a.includes(l._id);function k(g){x(g.target.value)}function E(){f.custom.promise(C.post(`${y.baseURL}/institutions/find`,{}).then(g=>{g.data.err?f.custom.error(g.data.err):m(g.data)}))}function q(){const g=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;o()==g||s()}function S(){C.get(`${y.baseURL}/config/`).then(g=>{g.data.err?f.custom.error(g.data.err):i(g.data.admins)})}return r.useEffect(()=>{n()?(E(),S(),q()):d("/login")},[]),t(Ee,{children:[t("div",{className:"flex justify-center items-center flex-row mx-2 mb-1",children:[t(Wt,{className:"mr-2",children:[e(Tt,{children:e(Ge,{})}),e(Mt,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:k,sx:{width:"100%"}})]}),e(De,{options:zt,onInputChange:(g,$)=>{w($)},className:"mt-3 w-full rounded-3xl",renderInput:g=>e(R,{variant:"outlined",...g,label:"Город"})})]}),e("div",{className:"flex justify-center flex-wrap",children:u.map((g,$)=>{var j;return((j=g==null?void 0:g.city)==null?void 0:j.includes(h))&&(g==null?void 0:g.title.includes(p))&&e(Pt,{imagePath:g.imagePath,name:g.title,status:g.status,description:g.description,address:g.address,id:g._id,link:g.link,userID:l._id,city:g.city},$)})})]})}function Ot(){const n=X(),d=Rt(),c=ae(),[l,s]=U.useState(""),[o,u]=U.useState(""),m=a=>{u(a.target.value)},p=a=>{s(a.target.value)},x=()=>{he.post(`${y.baseURL}/users/login`,{login:l,password:o}).then(a=>{if(!a.data.err)d({token:a.data.token,expiresIn:a.data.expiresIn,tokenType:"Bearer",authState:a.data.docs})?(location.reload(),f.login.success()):f.server.internalError();else{const i=a.data.err;f.custom.error(i)}})};return U.useEffect(()=>{c()&&n("/"),window.addEventListener("keypress",function(a){a.key==="Enter"&&(a.preventDefault(),document.getElementById("loginbtn").click())})},[]),t(B,{children:[e(xe,{}),e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Вход"}),t("p",{className:"text-sm",children:["Или ",e(et,{className:"",style:{color:b[7]},to:"/register",children:"создать новый аккаунт"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ke,{className:"mr-2"}),e(R,{label:"Логин",variant:"outlined",onChange:p})]}),t("div",{className:"flex flex-end items-center mb-4",children:[e(Qe,{className:"mr-2"}),e(R,{label:"Пароль",variant:"outlined",type:"password",onChange:m})]}),e(A,{id:"loginbtn",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},onClick:x,children:"Войти"})]})})]})}function Vt(){const n=X(),d=ae(),[c,l]=U.useState(""),[s,o]=U.useState(""),[u,m]=U.useState(""),[p,x]=U.useState(!1),a=S=>{o(S.target.value),x(!1)},i=S=>{l(S.target.value),x(!1)},h=S=>{m(S.target.value),x(!1)},w=()=>{if(c==""||s==""||u=="")return f.custom.error("Заполните все поля"),x(!0),null;he.post(`${y.baseURL}/users/register`,{login:c,password:s,inviteCode:u}).then(S=>(S.data.err?f.custom.error(S.data.err):n("/login"),null))};function k(){he.post(`${y.baseURL}/users/find`,{query:{login:c}}).then(S=>{S.data.err?f.custom.success("Этот логин можно использовать"):S.data.login==c&&(f.custom.error("Такой логин уже существует"),x(!0))})}function E(){(s.length<7||s=="")&&(f.custom.error("Пароль слишком короткий"),x(!0))}function q(){(u.length!=8||u=="")&&(f.custom.error("Неверный инвайт-код"),x(!0))}return U.useEffect(()=>{d()&&n("/")},[]),t(B,{children:[e(xe,{}),e("div",{className:"flex justify-center items-center h-screen flex-col",children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Регистрация"}),t("p",{className:"text-sm",children:["Уже есть аккаунт? ",e(et,{className:"",style:{color:b[7]},to:"/login",children:"Войти"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ke,{className:"mr-2"}),e(R,{label:"Логин",variant:"outlined",onChange:i,onBlur:k})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Qe,{className:"mr-2"}),e(R,{label:"Пароль",variant:"outlined",type:"password",onChange:a,onBlur:E})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(ut,{className:"mr-2"}),e(R,{label:"Инвайт-код",variant:"outlined",onChange:h,onBlur:q})]}),e("div",{className:"flex justify-center items-center",style:{marginTop:12},children:e(A,{onClick:w,sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},variant:"outlined",fullWidth:!0,disabled:p,children:"Зарегистрироваться"})})]})})]})}const Ht="/assets/patreon-app-icon-2b2458e8.png",Xt="/assets/author_picture-2c0ee235.png",Be=kt.a`
    text-decoration: none;
    color: white;
`;function Gt(){const n=ne(),d=Ze(),c=n()||{},[l,s]=r.useState(""),[o,u]=r.useState(0),[m,p]=r.useState(0);function x(){C.post(`${y.baseURL}/institutions/find`).then(a=>{if(a.data.err)f.custom.error(a.data.err);else{let i=[];a.data.map(w=>{w.userID==c._id&&i.push(w)}),u(i.length)}}),C.post(`${y.baseURL}/institutions/request/find`).then(a=>{if(a.data.err)f.custom.error(a.data.err);else{let i=[];a.data.map(w=>{w.userRequestID==c._id&&i.push(w)}),p(i.length)}})}return r.useEffect(()=>{s(c.inviteCode),x()},[]),e(Ee,{children:e("div",{className:"flex justify-center w-full",children:t("div",{className:"max-w-xl",children:[t(Ye,{children:[e(ee,{disablePadding:!0,children:t(Ae,{onClick:()=>{window.open("https://www.patreon.com/charlzWeb/membership","_blank")},children:[e(se,{children:e(te,{src:Ht})}),e(Q,{primary:"Patreon",secondary:"Поддержать проект"})]})}),t(ee,{children:[e(ke,{children:e(se,{children:e(mt,{})})}),e(Q,{primary:l,secondary:"Инвайт-код для друга"})]}),t(ee,{children:[e(ke,{children:e(se,{children:e($e,{})})}),e(Q,{primary:o,secondary:"Количество одобренных заведений"})]}),t(ee,{children:[e(ke,{children:e(se,{children:e($e,{})})}),e(Q,{primary:m,secondary:"Количество заведений в рассмотрении"})]}),e(ee,{disablePadding:!0,children:t(Ae,{onClick:()=>{d()},sx:{color:"#eb4034"},children:[e(se,{children:e(ht,{color:"error"})}),e(Q,{primary:"Выйти из аккаунта"})]})})]}),e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e(ft,{elevation:0,sx:{background:"none"},children:t("div",{style:{display:"flex",flexDirection:"column"},children:[t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(te,{src:Xt}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Be,{href:"https://github.com/bogdanshelest",target:"_blank",children:"Charlz"}),e(N,{variant:"body2",color:"text.secondary",children:"Разработчик и автор проекта"})]})]}),t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(te,{children:"S"}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Be,{target:"_blank",children:"Senrik_miele"}),e(N,{variant:"body2",color:"text.secondary",children:"Помощник и тестер сайта"})]})]})]})})})]})})})}function Kt({name:n,address:d,description:c,link:l,imagePath:s,city:o}){return t("div",{className:"my-1 rounded-2xl w-full",style:{backgroundColor:b[2],width:"95vw"},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(te,{children:n[0]})}),e("div",{className:"flex flex-col ml-4",children:e("h4",{className:"",style:{color:b[11]},children:n})})]}),s!=null&&s!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:s,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",o,", ",d]}),e(N,{variant:"body2",color:"text.secondary",children:c})]}),e("div",{className:"flex flex-start mt-7 flex-row px-4 pb-4",children:e("div",{className:"flex flex-row",children:t(de,{sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center",border:1},onClick:()=>{window.open(l,"_blank")},children:[e(je,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})})})]})}const Qt=G.div`
	display: flex;
	justify-content: center;
	flex-wrap: wrap;
	flex-direction: column;
`,Yt=G.div`
	display:flex;
	justify-content: center;
	align-items: center;
`,Jt=[{label:"Алматы"},{label:"Астана"},{label:"Шымкент"}];function Zt(){const n=ae(),d=ne(),c=X(),l=d()||{},[s,o]=r.useState(void 0),[u,m]=r.useState(""),[p,x]=r.useState(""),[a,i]=r.useState(""),[h,w]=r.useState(""),[k,E]=r.useState(""),[q,S]=r.useState(!1),[g,$]=r.useState(!1),[j,_]=r.useState([]),I=v=>{m(v.target.value)},W=v=>{x(v.target.value)},F=v=>{i(v.target.value)},K=v=>{w(v.target.value)},L=()=>{$(!1),window.location.reload()};async function O(){f.custom.promise(C.post(`${y.baseURL}/institutions/request/find`,{query:{}}).then(v=>{v.data.err?f.custom.error(v.data.err):_(v.data)}))}const Z=async()=>{if(me()){S(!0);const v=new FormData;v.append("title",u),v.append("description",p),v.append("link",a),v.append("address",h),v.append("userRequestID",l._id),v.append("image",s),v.append("city",k),C.post(`${y.baseURL}/institutions/request/new`,v,{headers:{"Content-Type":"multipart/form-data"}}).then(M=>{M.data.err?($(!1),S(!1),f.custom.error(M.data.err)):($(!0),S(!1))}),S(!1)}};function ue(){return s==null?"":URL.createObjectURL(s)}function me(){return u==""||p==""||k==""||h==""||a==""?(f.custom.error("Заполните все поля!"),!1):a.includes("https")||a.includes("http")?!0:(f.custom.error("Неверная ссылка"),!1)}return r.useEffect(()=>{n()?O():c("/login")},[]),t(Ee,{children:[t(qe,{open:g,onClose:L,children:[e(Me,{children:e(Le,{children:"Вы отправили свой запрос на добавление нового заведения в список. В течении некоторого времени, модераторы рассмотрят ваш запрос"})}),e(ze,{children:e(A,{onClick:L,autoFocus:!0,children:"ОК"})})]}),e("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:t("div",{className:"mb-1 mt-2 mx-2 rounded-2xl",style:{backgroundColor:b[2],maxWidth:"500px"},children:[t("div",{children:[e("p",{className:"ml-1 pt-4 px-4",children:"Запрос на добавление заведения"}),ue()&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:ue(),className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t(Ue,{sx:{display:"flex",flexDirection:"column"},className:"mt-2 px-4",children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-title",label:"Название",placeholder:'Ресторан "Открытый"',onChange:I}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-description",label:"Описание",multiline:!0,placeholder:"Очень крутое заведение...",onChange:W}),e(De,{disablePortal:!0,options:Jt,onInputChange:(v,M)=>{E(M)},fullWidth:!0,className:"mt-3 w-full",renderInput:v=>t(B,{children:[" ",e(R,{InputLabelProps:{shrink:!0},required:!0,...v,label:"Город"})," "]})}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-address",label:"Адрес",placeholder:"Мкр. Алтын 77",onChange:K}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-link",placeholder:"https://...",label:"Ссылка на метку в карте",onChange:F})]})]}),e("div",{className:"flex justify-between mt-3 flex-row px-4 pb-4",children:t("div",{className:"flex flex-row",children:[e(Y,{loading:q,onClick:Z,variant:"outlined",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center"},loadingIndicator:"Загрузка...",children:"Запросить"}),t(A,{variant:"outlined",sx:{borderColor:b[12],color:b[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginLeft:1,border:1},className:"flex justify-center items-center",component:"label",children:[e(gt,{sx:{marginRight:.3}}),e("p",{className:"text-xs w-min mr-1",children:"Добавить изображение "}),e("input",{type:"file",accept:"image/png, image/jpeg, image/jpg","data-filename":s,onChange:v=>{o(v.target.files[0])},hidden:!0})]})]})})]})}),e(Qt,{children:j.map(({title:v,address:M,description:be,link:ye,imagePath:ve,city:Ce},Ie)=>e(Yt,{children:e(Kt,{name:v,address:M,description:be,link:ye,imagePath:ve,city:Ce})},Ie))})]})}function en({id:n,name:d,address:c,description:l,link:s,imagePath:o,userID:u}){const[m,p]=r.useState(!1);function x(){p(!0),C.post(`${y.baseURL}/institutions/request/accept`,{query:{_id:n}}).then(i=>{i.data.err?f.custom.error(i.data.err):window.location.reload()})}function a(){p(!0),C.post(`${y.baseURL}/institutions/request/decline`,{query:{_id:n}}).then(i=>{i.data.err?f.custom.error(i.data.err):window.location.reload()})}return r.useEffect(()=>{p(!1)},[]),t(fe,{sx:{width:"95vw",maxWidth:500},square:!0,children:[e(ge,{title:d,subheader:`ID пользователя: ${u}`}),o!=null&&o!=""&&e(Je,{component:"img",height:"240",image:o}),t(ce,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",c]}),e(N,{variant:"body2",color:"text.secondary",children:l})]}),t(pe,{children:[e(Y,{size:"small",variant:"contained",onClick:()=>{window.open(s,"_blank")},children:"ССЫЛКА"}),t(B,{children:[e(Y,{color:"success",size:"small",variant:"contained",loading:m,onClick:()=>{x()},children:"Принять"}),e(Y,{color:"error",size:"small",variant:"contained",loading:m,onClick:()=>{a()},children:"Отклонить"})]})]})]})}const tn=[["Comments","/admin/comments"],["Users","/admin/user-control"],["Institutions","/admin/institution-control"],["Requests","/admin/request-institution-control"]],nn=[["Main","/admin"],["Settings","/admin/settings"],["Home","/"]],an=["/admin/comments","/admin/user-control","/admin/institution-control","/admin/request-institution-control"],rn=["/admin","/admin/settings","/"];function sn(){const[n,d]=r.useState(0),[c,l]=r.useState(0),s=X(),u=ne()();function m(){C.get(`${y.baseURL}/config/`).then(a=>{a.data.err?f.custom.error(a.data.err):a.data.admins.includes(u._id)||s("/")})}function p(a,i){return a==i?{backgroundColor:b[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}function x(a,i){return a==i?{backgroundColor:b[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}return r.useEffect(()=>{m(),d(an.indexOf(location.pathname)),l(rn.indexOf(location.pathname))},[]),t(B,{children:[e("div",{className:"fixed top-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:b[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:tn.map((a,i)=>e("button",{onClick:()=>{s(a[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:p(i,n),children:[i==0&&e(We,{}),i==1&&e(He,{}),i==2&&e($e,{}),i==3&&e(pt,{})]}),e("label",{children:a[0]})]})},i))})}),e("div",{className:"fixed bottom-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:b[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:nn.map((a,i)=>e("button",{onClick:()=>{s(a[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:x(i,c),children:[i==0&&e(Ve,{}),i==1&&e(xt,{}),i==2&&e(bt,{})]}),e("label",{children:a[0]})]})},i))})})]})}function ie(n){return t(B,{children:[e(xe,{}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(sn,{}),t("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"80vh",width:"100%",flexWrap:"wrap",marginTop:76},children:[n.children,e("div",{style:{width:1,height:1,marginTop:76}})]})]})]})}const ln=G.div`
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 100px;
`,on=G.div`
    display:flex;
    justify-content: center;
    align-items: center;
    margin: 10px;
    width: fit-content;
`;function dn(){const n=ae(),d=X(),[c,l]=r.useState([]);async function s(){C.post(`${y.baseURL}/institutions/request/find`,{query:{}}).then(o=>{o.data.err?f.custom.error(o.data.err):l(o.data)})}return r.useEffect(()=>{n()?s():d("/login")},[]),e(ie,{children:e(ln,{children:c.map(({_id:o,title:u,address:m,description:p,link:x,imagePath:a,userRequestID:i},h)=>e(on,{children:e(en,{id:o,name:u,address:m,description:p,link:x,imagePath:a,userID:i})},h))})})}const cn=J(n=>{const{expand:d,...c}=n;return e(de,{...c})})(({theme:n,expand:d})=>({transform:d?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})})),un=["Алматы","Астана","Шымкент"];function mn(n){const{open:d,institutionID:c,institutionTitle:l}=n,[s,o]=r.useState(""),[u,m]=r.useState(""),[p,x]=r.useState(""),[a,i]=r.useState(""),[h,w]=r.useState(""),[k,E]=r.useState(""),[q,S]=r.useState(!0);function g(){C.post(`${y.baseURL}/institutions/find`,{query:{_id:c}}).then(_=>{if(_.data.err)f.custom.error(_.data.err);else{const I=_.data[0];o(I.title),m(I.description),i(I.address),w(I.link),E(I.imagePath),x(I.city)}})}function $(_){_.preventDefault();const I=new FormData(_.currentTarget);C.post(`${y.baseURL}/institutions/edit`,{query:{_id:c},updated:{title:I.get("title"),description:I.get("description"),address:I.get("address"),link:I.get("link"),imagePath:I.get("imagePath")}}).then(W=>{W.data.err?f.custom.error(W.data.err):window.location.reload()})}function j(){document.getElementById("title").value=s,document.getElementById("description").value=u,document.getElementById("address").value=a,document.getElementById("link").value=h,document.getElementById("imagePath").value=k,document.getElementById("imagePath").value=p,S(!1)}return r.useEffect(()=>{g()},[]),t(qe,{open:d,children:[t(Te,{children:["Реадактировать заведение ",l]}),t(Ue,{component:"form",noValidate:!0,onSubmit:$,sx:{margin:1},children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"title",label:"Название заведения",name:"title"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"description",label:"Описание",id:"description"}),e(De,{options:un,onInputChange:(_,I)=>{x(I)},className:"mt-3 w-full rounded-3xl",renderInput:_=>e(R,{variant:"outlined",..._,label:"Город",id:"city"})}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"address",label:"Адрес",id:"address"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"link",label:"Ссылка",id:"link"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"imagePath",label:"Путь к картинке",id:"imagePath"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(A,{type:"submit",color:"success",fullWidth:!0,variant:"contained",sx:{mt:2,mb:2,mr:1},disabled:q,children:"Сохранить"}),e(A,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{j()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})]})}function hn({userID:n,rate:d,comment:c}){const[l,s]=r.useState("");function o(){const u={query:{_id:n}};C.post(`${y.baseURL}/users/find`,u).then(m=>{m.data.err?f.custom.error(m.data.err):s(m.data.login)})}return r.useEffect(()=>{o()},[]),t(B,{children:[e(ee,{alignItems:"flex-start",children:e(Q,{primary:l+` - ${d}`,secondary:e(U.Fragment,{children:c})})}),e(Oe,{})]})}function fn({comments:n,expanded:d,id:c}){return e(vt,{in:d,timeout:"auto",unmountOnExit:!0,children:t(ce,{children:[e(N,{paragraph:!0,children:"Comments:"}),e(Ye,{sx:{width:"100%",maxWidth:"500px"},children:n.map(({rate:l,userID:s,institutionID:o,content:u},m)=>o==c&&e(hn,{userID:s,rate:l,comment:u},m))})]})})}function gn({userID:n,id:d,name:c,address:l,description:s,link:o,imagePath:u}){n==null&&(localStorage.removeItem("token"),location.reload());const[m,p]=r.useState(""),[x,a]=r.useState(""),[i,h]=r.useState([]),[w,k]=r.useState(!1),[E,q]=r.useState(!1),S=()=>{k(!w)};function g(){C.post(`${y.baseURL}/institutions/remove`,{query:{_id:d}}).then(I=>{I.data.err?f.custom.error(I.data.err):window.location.reload()})}function $(){q(!0)}function j(){q(!1)}function _(){C.post(`${y.baseURL}/comments/get`,{query:{institutionID:d}}).then(I=>{if(I.data.err)f.custom.error(I.data.err);else{let W=I.data;h(W);let F=0,K=0;for(let O=0;O<W.length;O++){let Z=W[O].rate;F=F+parseInt(Z),K++}let L=Math.ceil(F/K*10)/10;L>0||(L=5),L>=8?(p(L.toString()),a(oe[800])):L>=6?(p(L.toString()),a(oe[400])):L>=4?(p(L.toString()),a(Ne[800])):L>=2?(p(L.toString()),a(le[300])):L>=0?(p(L.toString()),a(le[800])):(p("X"),a(Fe[50]))}})}return r.useEffect(()=>{_()},[]),t(fe,{sx:{width:"95vw",maxWidth:"500px",marginBottom:-1.1},children:[e(mn,{open:E,onClose:j,institutionID:d,institutionTitle:c}),e(ge,{title:c,subheader:`ID пользователя: ${n}`,avatar:t(te,{sx:{bgcolor:x},"aria-label":"recipe",children:[" ",m," "]})}),u!=null&&u!=""&&e(Je,{component:"img",height:"240",image:u}),t(ce,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Адрес: ",l]}),e(N,{variant:"body2",color:"text.secondary",children:s})]}),t(pe,{disableSpacing:!0,children:[e(A,{size:"small",onClick:()=>{window.open(o,"_blank")},children:"ССЫЛКА"}),e(A,{size:"small",onClick:()=>{g()},children:"УДАЛИТЬ"}),e(A,{size:"small",onClick:()=>{$()},children:"РЕАДАКТИРОВАТЬ"}),e(cn,{expand:w,onClick:S,"aria-expanded":w,"aria-label":"show more",children:e(yt,{})})]}),e(fn,{expanded:w,comments:i,id:d})]})}const pn=G.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
`,xn=G.div`
  display:flex;
  justify-content: center;
  align-items: center;
  margin: 10px;
  width: fit-content;
`,bn=J("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:_e(n.palette.common.white,.15),"&:hover":{backgroundColor:_e(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),yn=J("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"})),vn=J(Xe)(({theme:n})=>({color:"inherit","& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%"}}));function Cn(){const n=ae(),d=X(),l=ne()(),[s,o]=r.useState([]),[u,m]=r.useState("");function p(a){m(a.target.value)}async function x(){C.post(`${y.baseURL}/institutions/find`,{}).then(a=>{a.data.err?f.custom.error(a.data.err):o(a.data)})}return r.useEffect(()=>{n()?x():d("/login")},[]),e(ie,{children:t("div",{className:"flex flex-col absolute top-20",children:[e("div",{style:{display:"flex",justifyContent:"center"},children:t(bn,{children:[e(yn,{children:e(Ge,{})}),e(vn,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:p})]})}),e(pn,{children:s.map((a,i)=>a.title.includes(u)&&e(xn,{children:e(gn,{imagePath:a.imagePath,name:a.title,status:a.status,description:a.description,address:a.address,id:a._id,link:a.link,userID:l._id})},i))})]})})}function In(){return e(ie,{})}function wn({id:n,login:d,inviteCode:c,acceptCode:l}){const[s,o]=r.useState(!1);function u(){C.post(`${y.baseURL}/users/remove`,{query:{id:n}}).then(m=>{m.data.err?f.custom.error(m.data.err):location.reload()})}return r.useEffect(()=>{o(!1)},[]),t(fe,{sx:{width:"95vw",maxWidth:250},square:!0,children:[e(ge,{title:d}),t(ce,{children:[t(N,{variant:"body2",color:"text.secondary",children:["ID: ",n]}),t(N,{variant:"body2",color:"text.secondary",children:["Invite Code: ",c]}),t(N,{variant:"body2",color:"text.secondary",children:["Accept Code: ",l]})]}),e(pe,{children:e(Y,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:s,onClick:()=>{u()},children:"Удалить"})})]})}const Sn=G.div`
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
`,Rn=G.div`
    display:flex;
    justify-content: center;
    align-items: center;
    margin: 10px;
    width: fit-content;
`;function kn(){const[n,d]=r.useState([]);async function c(){C.post(`${y.baseURL}/users/find/all`).then(l=>{l.data.err?f.custom.error(l.data.err):d(l.data)})}return r.useEffect(()=>{c()},[]),e(ie,{children:e(Sn,{children:n.map(({_id:l,login:s,inviteCode:o,acceptCode:u},m)=>l!=qt&&e(Rn,{children:e(wn,{id:l,login:s,inviteCode:o,acceptCode:u})},m))})})}function Nn(){const[n,d]=r.useState(""),[c,l]=r.useState(""),[s,o]=r.useState([]),[u,m]=r.useState(!0);function p(){C.get(`${y.baseURL}/config/`).then(i=>{i.data.err?f.custom.error(i.data.err):(d(i.data.name),l(i.data.version),o(i.data.admins))})}function x(i){i.preventDefault();const h=new FormData(i.currentTarget);let w=h.get("admins").toString().split(",");w.includes("639f32ed1e7c8b26f1bceaac")||w.push("639f32ed1e7c8b26f1bceaac"),C.post(`${y.baseURL}/config/update`,{name:h.get("name"),version:h.get("version"),admins:w}).then(k=>{k.data.err?f.custom.error(k.data.err):location.reload()})}function a(){let i="";for(let h=0;h<s.length;h++)h==s.length-1?i+=s[h]:i+=s[h]+",";document.getElementById("name").value=n,document.getElementById("version").value=c,document.getElementById("admins").value=i,m(!1)}return r.useEffect(()=>{p()},[]),e(ie,{children:t(Ue,{component:"form",noValidate:!0,onSubmit:x,className:"p-4",children:[e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Имя проекта",name:"name"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"version",label:"Версия",type:"version",id:"version"}),e(R,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"admins",label:"Админы (перечислите ID пользователей через запятые без пробелов)",type:"admins",id:"admins"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(A,{type:"submit",color:"success",fullWidth:!0,variant:"contained",size:"small",sx:{mt:2,mb:2},disabled:u,children:"Сохранить"}),e(A,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{a()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})})}function Ln({_id:n,userID:d,institutionID:c,content:l,rate:s}){const[o,u]=r.useState(!1),[m,p]=r.useState("");function x(){C.post(`${y.baseURL}/comments/remove`,{query:{_id:n}}).then(i=>{i.data.err?f.custom.error(i.data.err):window.location.reload()})}function a(){const i={query:{_id:d}};C.post(`${y.baseURL}/users/find`,i).then(h=>{h.data.err?f.custom.error(h.data.err):p(h.data.login)})}return r.useEffect(()=>{u(!1),a()},[]),t(fe,{sx:{width:"95vw",maxWidth:250,margin:1},children:[e(ge,{title:m}),t(ce,{children:[t(N,{variant:"body2",color:"text.secondary",children:["Rate: ",s]}),t(N,{variant:"body2",color:"text.secondary",children:["Comment ID: ",n]}),t(N,{variant:"body2",color:"text.secondary",children:["User ID: ",d]}),t(N,{variant:"body2",color:"text.secondary",children:["Institution ID: ",c]}),t(N,{variant:"body2",color:"text.secondary",children:["Comment Text: ",l]})]}),e(pe,{children:e(Y,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:o,onClick:()=>{x()},children:"Удалить"})})]})}function _n(){const[n,d]=r.useState([]);function c(){C.post(`${y.baseURL}/comments/get`,{query:{}}).then(l=>{l.data.err?f.custom.error(l.data.err):d(l.data)})}return r.useEffect(()=>{c()},[]),e(ie,{children:n.map((l,s)=>e(Ln,{_id:l._id,userID:l.userID,institutionID:l.institutionID,content:l.content,rate:l.rate},s))})}function $n(){return e(Nt,{children:t(Lt,{children:[e(P,{path:"/login",element:e(Ot,{})}),e(P,{path:"/register",element:e(Vt,{})}),e(P,{path:"/",element:e(z,{loginPath:"/login",children:e(Ft,{})})}),e(P,{path:"/request",element:e(z,{loginPath:"/login",children:e(Zt,{})})}),e(P,{path:"/settings",element:e(z,{loginPath:"/login",children:e(Gt,{})})}),e(P,{path:"/admin",element:e(z,{loginPath:"/login",children:e(In,{})})}),e(P,{path:"/admin/institution-control",element:e(z,{loginPath:"/login",children:e(Cn,{})})}),e(P,{path:"/admin/request-institution-control",element:e(z,{loginPath:"/login",children:e(dn,{})})}),e(P,{path:"/admin/user-control",element:e(z,{loginPath:"/login",children:e(kn,{})})}),e(P,{path:"/admin/settings",element:e(z,{loginPath:"/login",children:e(Nn,{})})}),e(P,{path:"/admin/comments",element:e(z,{loginPath:"/login",children:e(_n,{})})})]})})}function qn(){return e(_t,{authType:"localstorage",authName:"_auth",children:e($n,{})})}const Dn=Ct({palette:{mode:"dark",primary:{main:"#6750a4"},secondary:{main:"#625b71"}},shape:{borderRadius:15}});$t.createRoot(document.getElementById("root")).render(e(r.StrictMode,{children:t(It,{theme:Dn,children:[e(wt,{}),e(qn,{})]})}));
