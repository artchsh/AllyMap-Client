import{j as e,d as ot,r as de,a as dt,y as we,b as ct,c as ce,e as t,F as D,A as ie,T as L,I as ue,f as ut,h as Be,i as je,D as Le,k as We,l as Te,m as ke,S as mt,n as q,o as Me,L as ee,p as $e,q as Fe,s as J,t as Y,u as ze,v as Oe,w as ht,x as Ve,z as Ae,B as te,C as qe,E as He,G as Xe,H as De,J as Ge,K as Ke,M as W,N as ft,O as fe,P as oe,Q as gt,R as pt,U as Ne,V as yt,W as bt,X as _e,Y as xt,Z as pe,_ as ye,$ as Qe,a0 as me,a1 as be,a2 as vt,a3 as Ct,a4 as It,a5 as Rt,a6 as St,a7 as wt,a8 as kt,a9 as qt}from"./mui-b7647d06.js";import{h as ge,l as V,p as h,r as i,m as Z,u as X,o as re,I as xe,q as ae,s as Je,t as Nt,v as Lt,L as Ye,n as $t,w as G,B as Dt,x as _t,y as j,z as M,A as Ut,C as Pt}from"./vendor-2422e600.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function c(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(a){if(a.ep)return;a.ep=!0;const o=c(a);fetch(a.href,o)}})();let At=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;const R=ge.create({headers:{Authorization:At}}),H={style:{borderRadius:"15px",background:"#302d38",color:"#fff"}},f={custom:{error:n=>{V.error(n,H)},success:n=>{V.success(n,H)},promise:n=>{V.promise(n,{loading:"Загрузка...",success:"Успешно загружено!",error:"Произошла ошибка"},H)}},login:{success:()=>{V.success("Вы успешно вошли!",H)},invalid:()=>{V.error("Неправильный логин или пароль.",H)}},register:{success:()=>{V.success("Вы успешно зарегистрировались!",H)},invalid:()=>{V.error("Такой логин уже существует",H)}},server:{internalError:()=>{V.error("Что-то пошло не так",H)}}},C={baseURL:"https://hammerhead-app-q63fx.ondigitalocean.app"},Et="639f32ed1e7c8b26f1bceaac",v={1:"#1c1b1f",2:"#25232a",3:"#2b2831",4:"#49454f",5:"#4a4458",6:"#cac4d0",7:"#d0bcff",8:"#e8def8",9:"#302d38",10:"#6a6571",11:"#E6E1E5",12:"#938F99"};function Bt({userID:n,rate:d,comment:c}){const[l,a]=i.useState("");function o(){let u={query:{_id:n}};R.post(`${C.baseURL}/users/find`,u).then(m=>{m.data.err?f.custom.error(m.data.err):a(m.data.login)})}return i.useEffect(()=>{o()},[]),t(D,{children:[e(J,{alignItems:"flex-start",children:e(Y,{primary:l+` - ${d}`,secondary:e(Z.Fragment,{children:c})})}),e(ze,{})]})}function Ze({comments:n,id:d}){return e($e,{sx:{width:"100%",maxWidth:"500px"},children:n.map(({rate:c,userID:l,institutionID:a,content:o},u)=>a==d&&e(Bt,{userID:l,rate:c,comment:o},u))})}function et({userID:n,id:d,name:c,address:l,status:a,description:o,link:u,imagePath:m,city:b}){const[x,s]=i.useState(!1),[r,y]=i.useState(""),[S,g]=i.useState(""),[_,U]=i.useState([]),[k,P]=i.useState(!1),[p,A]=i.useState(5),[N,w]=i.useState(""),[T,F]=i.useState(!1),[K,$]=i.useState(1),[z,ne]=i.useState(!1),he=E=>{let Q=E.target;A(parseInt(Q.value))},ve=E=>{w(E.target.value)};n==null&&(localStorage.removeItem("token"),location.reload());function I(){$(K+1)}function O(){P(!0),N!=""?R.post(`${C.baseURL}/comments/add`,{userID:n,institutionID:d,content:N,rate:p}).then(E=>{E.data.err?f.custom.error(E.data.err):(s(!1),P(!1),f.custom.success("Вы успешно оставили свою оценку! Спасибо Вам!"),I())}):(F(!0),P(!1))}function Ce(){R.post(`${C.baseURL}/comments/get`,{query:{institutionID:d}}).then(E=>{if(E.data.err)f.custom.error(E.data.err);else{let Q=E.data;U(Q);let Re=0,Pe=0;for(let Se=0;Se<Q.length;Se++){let lt=Q[Se].rate;Re=Re+parseInt(lt),Pe++}let B=Math.ceil(Re/Pe*10)/10;B>0||(B=5),B>=8?(y(B.toString()),g(ce[800])):B>=6?(y(B.toString()),g(ce[400])):B>=4?(y(B.toString()),g(we[800])):B>=2?(y(B.toString()),g(de[300])):B>=0?(y(B.toString()),g(de[800])):(y("X"),g(Fe[50]))}})}const Ie=[{value:0,label:e(ot,{sx:{color:de[500]}})},{value:5,label:e(dt,{sx:{color:we[400]}})},{value:10,label:e(ct,{sx:{color:ce[300]}})}];i.useEffect(()=>{Ce()},[K]);let le={display:"none",zIndex:500,backgroundColor:"rgb(0,0,0,0.5)"};return z?le.display="block":le.display="none",t(D,{children:[t("div",{className:"my-1 mx-2 rounded-2xl w-full",style:{backgroundColor:v[2],maxWidth:"500px"},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(ie,{sx:{bgcolor:S},children:r})}),t("div",{className:"flex flex-col ml-4",children:[e("h4",{className:"",style:{color:v[11]},children:c}),e("p",{style:{color:v[11]},children:a[1]})]})]}),m!=null&&m!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:m,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(L,{variant:"body2",color:"text.secondary",children:["Адрес: ",b,", ",l]}),e(L,{variant:"body2",color:"text.secondary",children:o})]}),t("div",{className:"flex justify-between mt-7 flex-row px-4 pb-4",children:[t("div",{className:"flex flex-row",children:[t(ue,{sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginRight:1,border:1},onClick:()=>{s(!0)},children:[e(ut,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Оценить"})]}),t(ue,{sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",border:1},onClick:()=>{window.open(u,"_blank")},children:[e(Be,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})]}),e("div",{children:e(ue,{onClick:()=>{ne(!0)},children:e(je,{})})})]})]}),z&&e("div",{className:"fixed top-0 bottom-0 left-0 right-0 border-none animate__animated animate__fadeIn",style:le,children:t("div",{className:"relative flex flex-col items-center h-full w-full animate__animated animate__slideInUp",children:[e("div",{onClick:()=>{ne(!1)},className:"h-1/3 w-full"}),t("div",{style:{backgroundColor:v[2],zIndex:1e3},className:"h-2/3 absolute bottom-0 w-11/12 p-4 rounded-t-2xl",children:[e("h1",{className:"text-xl",children:"Комментарии"}),e(Ze,{comments:_,id:d})]})]})}),t(Le,{open:x,onClose:()=>{s(!1)},className:"animate__animated animate__fadeIn",children:[e(We,{children:"Оценка"}),t(Te,{children:[e(ke,{children:"Пожалуйста, оцените отношение к представителям LGBTQIA в данном заведении"}),e(mt,{"aria-label":"Always visible",defaultValue:5,onChange:he,step:1,marks:Ie,valueLabelDisplay:"on",min:0,max:10}),e(ke,{sx:{marginBottom:1},children:"Оставьте комментарий:"}),e(q,{error:T,variant:"outlined",multiline:!0,fullWidth:!0,minRows:3,onChange:ve,onClick:()=>{F(!1)},required:!0})]}),e(Me,{sx:{marginRight:2,marginBottom:2,bgColor:v[2]},children:e(ee,{variant:"outlined",loading:k,onClick:()=>{P(!0),O()},sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px"},children:"Оценить"})})]})]})}et.propTypes={name:h.string.isRequired,id:h.string.isRequired,userID:h.string.isRequired,address:h.any,status:h.array.isRequired,description:h.string.isRequired,link:h.string.isRequired,imagePath:h.string,city:h.string.isRequired};Ze.propTypes={comments:h.array.isRequired,id:h.string.isRequired};const jt=[["Главная","/"],["Запросы","/request"],["Профиль","/settings"]],Wt=["/","/request","/settings"];function Tt(){const[n,d]=i.useState([]),[c,l]=i.useState(0),a=X(),u=re()(),m=n.includes(u._id);function b(){R.get(`${C.baseURL}/config/`).then(s=>{if(s.data.err)f.custom.error(s.data.err);else{let r=s.data.admins;d(r)}})}function x(s,r){return s==r?{backgroundColor:v[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}return i.useEffect(()=>{b(),l(Wt.indexOf(location.pathname))},[]),e("header",{className:"fixed bottom-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:v[3]},children:t("div",{className:"flex flex-row items-center justify-around h-full",children:[jt.map((s,r)=>e("button",{onClick:()=>{a(s[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:x(r,c),children:[r==0&&e(Oe,{}),r==1&&e(ht,{}),r==2&&e(Ve,{}),r==3&&e(Ae,{})]}),e("label",{children:s[0]})]})},r)),m&&e("button",{onClick:()=>{a("/admin")},children:t("div",{className:"flex flex-col justify-center items-center",children:[e("div",{style:x(3,c),children:e(Ae,{})}),e("label",{children:"Админ"})]})})]})})}function Ue(n){return t(D,{children:[e(xe,{}),e(Tt,{}),e("main",{children:n.children})]})}const Mt=te("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:15,height:55,backgroundColor:v[9],"&:hover":{backgroundColor:qe(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),Ft=te("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:v[6]})),zt=te(He)(({theme:n})=>({color:v[6],"& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%",height:"100%",display:"flex",alignItems:"center"},height:"100%"})),Ot=["Алматы","Астана","Шымкент"];function Vt(){const n=ae(),d=X(),l=re()()||{},a=Je(),o=Nt(),[u,m]=i.useState([]),[b,x]=i.useState(""),[s,r]=i.useState([]),[y,S]=i.useState(""),g=s.includes(l._id);function _(p){x(p.target.value)}function U(){f.custom.promise(R.post(`${C.baseURL}/institutions/find`,{}).then(p=>{p.data.err?f.custom.error(p.data.err):m(p.data)}))}function k(){const p=`${localStorage.getItem("_auth_type")} ${localStorage.getItem("_auth")}`;o()==p||a()}function P(){R.get(`${C.baseURL}/config/`).then(p=>{p.data.err?f.custom.error(p.data.err):r(p.data.admins)})}return i.useEffect(()=>{n()?(U(),P(),k()):d("/login")},[]),t(Ue,{children:[t("div",{className:"flex justify-center items-center flex-row mx-2 mb-1",children:[t(Mt,{className:"mr-2",children:[e(Ft,{children:e(Xe,{})}),e(zt,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:_,sx:{width:"100%"}})]}),e(De,{options:Ot,onInputChange:(p,A)=>{S(A)},className:"mt-3 w-full rounded-3xl",renderInput:p=>e(q,{variant:"outlined",...p,label:"Город"})})]}),e("div",{className:"flex justify-center flex-wrap",children:u.map((p,A)=>{var N;return((N=p==null?void 0:p.city)==null?void 0:N.includes(y))&&(p==null?void 0:p.title.includes(b))&&e(et,{imagePath:p.imagePath,name:p.title,status:p.status,description:p.description,address:p.address,id:p._id,link:p.link,userID:l._id,isAdmin:g,city:p.city},A)})}),e("div",{className:"mt-20"})]})}function Ht(){const n=X(),d=Lt(),c=ae(),[l,a]=i.useState(""),[o,u]=i.useState(""),m=s=>{u(s.target.value)},b=s=>{a(s.target.value)},x=()=>{ge.post(`${C.baseURL}/users/login`,{login:l,password:o}).then(s=>{if(!s.data.err)d({token:s.data.token,expiresIn:s.data.expiresIn,tokenType:"Bearer",authState:s.data.docs})?(location.reload(),f.login.success()):f.server.internalError();else{const r=s.data.err;f.custom.error(r)}})};return i.useEffect(()=>{c()&&n("/"),window.addEventListener("keypress",function(s){s.key==="Enter"&&(s.preventDefault(),document.getElementById("loginbtn").click())})},[]),t(D,{children:[e(xe,{}),e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Вход"}),t("p",{className:"text-sm",children:["Или ",e(Ye,{className:"",style:{color:v[7]},to:"/register",children:"создать новый аккаунт"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ge,{className:"mr-2"}),e(q,{label:"Логин",variant:"outlined",onChange:b})]}),t("div",{className:"flex flex-end items-center mb-4",children:[e(Ke,{className:"mr-2"}),e(q,{label:"Пароль",variant:"outlined",type:"password",onChange:m})]}),e(W,{id:"loginbtn",sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},onClick:x,children:"Войти"})]})})]})}function Xt(){const n=X(),d=ae(),[c,l]=Z.useState(""),[a,o]=Z.useState(""),[u,m]=Z.useState(""),[b,x]=Z.useState(!1),s=k=>{o(k.target.value),x(!1)},r=k=>{l(k.target.value),x(!1)},y=k=>{m(k.target.value),x(!1)},S=()=>{if(c==""||a==""||u=="")return f.custom.error("Заполните все поля"),x(!0),null;ge.post(`${C.baseURL}/users/register`,{login:c,password:a,inviteCode:u}).then(k=>(k.data.err?f.custom.error(k.data.err):n("/login"),null))};function g(){ge.post(`${C.baseURL}/users/find`,{query:{login:c}}).then(k=>{k.data.err?f.custom.success("Этот логин можно использовать"):k.data.login==c&&(f.custom.error("Такой логин уже существует"),x(!0))})}function _(){(a.length<7||a=="")&&(f.custom.error("Пароль слишком короткий"),x(!0))}function U(){(u.length!=8||u=="")&&(f.custom.error("Неверный инвайт-код"),x(!0))}return Z.useEffect(()=>{d()&&n("/")},[]),t(D,{children:[e(xe,{}),e("div",{className:"flex justify-center items-center h-screen flex-col",children:t("div",{children:[t("div",{className:"mb-2",children:[e("h1",{className:"text-2xl",children:"Регистрация"}),t("p",{className:"text-sm",children:["Уже есть аккаунт? ",e(Ye,{className:"",style:{color:v[7]},to:"/login",children:"Войти"})]})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ge,{className:"mr-2"}),e(q,{label:"Логин",variant:"outlined",onChange:r,onBlur:g})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(Ke,{className:"mr-2"}),e(q,{label:"Пароль",variant:"outlined",type:"password",onChange:s,onBlur:_})]}),t("div",{className:"flex flex-end items-center mb-2",children:[e(ft,{className:"mr-2"}),e(q,{label:"Инвайт-код",variant:"outlined",onChange:y,onBlur:U})]}),e("div",{className:"flex justify-center items-center",style:{marginTop:12},children:e(W,{onClick:S,sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,width:"100%",border:1},variant:"outlined",fullWidth:!0,disabled:b,children:"Зарегистрироваться"})})]})})]})}const Gt="/assets/patreon-app-icon-2b2458e8.png",Kt="/assets/author_picture-2c0ee235.png",Ee=$t.a`
    text-decoration: none;
    color: white;

`;function Qt(){const n=re(),d=Je(),c=n()||{},[l,a]=i.useState(""),[o,u]=i.useState(0),[m,b]=i.useState(0);function x(){R.post(`${C.baseURL}/institutions/find`).then(s=>{if(s.data.err)f.custom.error(s.data.err);else{let r=[];s.data.map(S=>{S.userID==c._id&&r.push(S)}),u(r.length)}}),R.post(`${C.baseURL}/institutions/request/find`).then(s=>{if(s.data.err)f.custom.error(s.data.err);else{let r=[];s.data.map(S=>{S.userRequestID==c._id&&r.push(S)}),b(r.length)}})}return i.useEffect(()=>{a(c.inviteCode),x()},[]),t(Ue,{children:[t($e,{children:[e(J,{disablePadding:!0,children:t(fe,{onClick:()=>{window.open("https://www.patreon.com/charlzWeb/membership","_blank")},children:[e(oe,{children:e(ie,{src:Gt})}),e(Y,{primary:"Patreon",secondary:"Поддержать проект"})]})}),t(J,{children:[e(gt,{children:e(oe,{children:e(pt,{})})}),e(Y,{primary:l,secondary:"Инвайт-код для друга"})]}),e(J,{disablePadding:!0,children:t(fe,{children:[e(oe,{children:e(Ne,{})}),e(Y,{primary:o,secondary:"Количество одобренных заведений"})]})}),e(J,{disablePadding:!0,children:t(fe,{children:[e(oe,{children:e(Ne,{})}),e(Y,{primary:m,secondary:"Количество заведений в рассмотрении"})]})}),e(J,{disablePadding:!0,children:t(fe,{onClick:()=>{d()},sx:{color:"#eb4034"},children:[e(oe,{children:e(yt,{color:"error"})}),e(Y,{primary:"Выйти из аккаунта"})]})})]}),e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e(bt,{elevation:0,sx:{background:"none"},children:t("div",{style:{display:"flex",flexDirection:"column"},children:[t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(ie,{src:Kt}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Ee,{href:"https://github.com/bogdanshelest",target:"_blank",children:"Charlz"}),e(L,{variant:"body2",color:"text.secondary",children:"Разработчик и автор проекта"})]})]}),t("div",{style:{display:"flex",flexDirection:"row",margin:10,background:"none"},children:[e(ie,{children:"S"}),t("div",{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[e(Ee,{target:"_blank",children:"Senrik_miele"}),e(L,{variant:"body2",color:"text.secondary",children:"Помощник и тестер сайта"})]})]})]})})})]})}function tt({name:n,address:d,description:c,link:l,imagePath:a,city:o}){return e(D,{children:t("div",{className:"my-1 rounded-2xl w-full",style:{backgroundColor:v[2],width:"95vw"},children:[t("div",{className:"flex flex-start flex-row items-center p-4 pb-0",children:[e("div",{className:"flex rounded-full",children:e(ie,{children:n[0]})}),e("div",{className:"flex flex-col ml-4",children:e("h4",{className:"",style:{color:v[11]},children:n})})]}),a!=null&&a!=""&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:a,className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t("div",{className:"mt-4 px-4 ",children:[t(L,{variant:"body2",color:"text.secondary",children:["Адрес: ",o,", ",d]}),e(L,{variant:"body2",color:"text.secondary",children:c})]}),e("div",{className:"flex flex-start mt-7 flex-row px-4 pb-4",children:e("div",{className:"flex flex-row",children:t(ue,{sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center",border:1},onClick:()=>{window.open(l,"_blank")},children:[e(Be,{})," ",e("p",{className:"text-sm ml-2 mr-2",children:"Ссылка"})]})})})]})})}tt.propTypes={name:h.string.isRequired,address:h.any,description:h.string.isRequired,link:h.string.isRequired,imagePath:h.string,city:h.string.isRequired};const Jt=G.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 30px;
`,Yt=G.div`
  display:flex;
  justify-content: center;
  align-items: center;
`,Zt=[{label:"Алматы"},{label:"Астана"},{label:"Шымкент"}];function en(){const n=ae(),d=re(),c=X(),l=d()||{},[a,o]=i.useState(void 0),[u,m]=i.useState(""),[b,x]=i.useState(""),[s,r]=i.useState(""),[y,S]=i.useState(""),[g,_]=i.useState(""),[U,k]=i.useState(!1),[P,p]=i.useState(!1),[A,N]=i.useState([]),w=I=>{m(I.target.value)},T=I=>{x(I.target.value)},F=I=>{r(I.target.value)},K=I=>{S(I.target.value)},$=()=>{p(!1),window.location.reload()};async function z(){f.custom.promise(R.post(`${C.baseURL}/institutions/request/find`,{query:{}}).then(I=>{I.data.err?f.custom.error(I.data.err):N(I.data)}))}const ne=async()=>{if(ve()){k(!0);const I=new FormData;I.append("title",u),I.append("description",b),I.append("link",s),I.append("address",y),I.append("userRequestID",l._id),I.append("image",a),I.append("city",g),R.post(`${C.baseURL}/institutions/request/new`,I,{headers:{"Content-Type":"multipart/form-data"}}).then(O=>{O.data.err?(p(!1),k(!1),f.custom.error(O.data.err)):(p(!0),k(!1))}),k(!1)}};function he(){return a==null?"":URL.createObjectURL(a)}function ve(){return u==""||b==""||g==""||y==""||s==""?(f.custom.error("Заполните все поля!"),!1):s.includes("https")||s.includes("http")?!0:(f.custom.error("Неверная ссылка"),!1)}return i.useEffect(()=>{n()?z():c("/login")},[]),t(Ue,{children:[t(Le,{open:P,onClose:$,children:[e(Te,{children:e(ke,{children:"Вы отправили свой запрос на добавление нового заведения в список. В течении некоторого времени, модераторы рассмотрят ваш запрос"})}),e(Me,{children:e(W,{onClick:$,autoFocus:!0,children:"ОК"})})]}),e("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:t("div",{className:"mb-1 mt-2 mx-2 rounded-2xl",style:{backgroundColor:v[2],maxWidth:"500px"},children:[t("div",{children:[e("p",{className:"ml-1 pt-4 px-4",children:"Запрос на добавление заведения"}),he()&&e("div",{className:"pt-2 mt-2 mb-2",children:e("div",{className:"flex justify-center ",children:e("img",{src:he(),className:"min-w-full",style:{aspectRatio:"1/1",objectFit:"cover",overflow:"hidden"}})})}),t(_e,{sx:{display:"flex",flexDirection:"column"},className:"mt-2 px-4",children:[e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-title",label:"Название",placeholder:'Ресторан "Открытый"',onChange:w}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-description",label:"Описание",multiline:!0,placeholder:"Очень крутое заведение...",onChange:T}),e(De,{disablePortal:!0,options:Zt,onInputChange:(I,O)=>{_(O)},fullWidth:!0,className:"mt-3 w-full",renderInput:I=>t(D,{children:[" ",e(q,{InputLabelProps:{shrink:!0},required:!0,...I,label:"Город"})," "]})}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-address",label:"Адрес",placeholder:"Мкр. Алтын 77",onChange:K}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,id:"input-link",placeholder:"https://...",label:"Ссылка на метку в карте",onChange:F})]})]}),e("div",{className:"flex justify-between mt-3 flex-row px-4 pb-4",children:t("div",{className:"flex flex-row",children:[e(ee,{loading:U,onClick:ne,variant:"outlined",sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",display:"flex",justifyContent:"center",alignItems:"center"},loadingIndicator:"Загрузка...",children:"Запросить"}),t(W,{variant:"outlined",sx:{borderColor:v[12],color:v[7],borderRadius:9999,fontWeight:500,paddingLeft:"12px",paddingRight:"12px",marginLeft:1,border:1},className:"flex justify-center items-center",component:"label",children:[e(xt,{sx:{marginRight:.3}}),e("p",{className:"text-xs w-min mr-1",children:"Добавить изображение "}),e("input",{type:"file",accept:"image/png, image/jpeg, image/jpg","data-filename":a,onChange:I=>{o(I.target.files[0])},hidden:!0})]})]})})]})}),e(Jt,{style:{display:"flex",justifyContent:"center",flexDirection:"column",marginBottom:100},children:A.map(({title:I,address:O,description:Ce,link:Ie,imagePath:le,city:E},Q)=>e(Yt,{children:e(tt,{name:I,address:O,description:Ce,link:Ie,imagePath:le,city:E})},Q))})]})}function nt({id:n,name:d,address:c,description:l,link:a,imagePath:o,userID:u}){const[m,b]=i.useState(!1);function x(){b(!0),R.post(`${C.baseURL}/institutions/request/accept`,{query:{_id:n}}).then(r=>{r.data.err?f.custom.error(r.data.err):window.location.reload()})}function s(){b(!0),R.post(`${C.baseURL}/institutions/request/decline`,{query:{_id:n}}).then(r=>{r.data.err?f.custom.error(r.data.err):window.location.reload()})}return i.useEffect(()=>{b(!1)},[]),e(D,{children:t(pe,{sx:{width:"95vw",maxWidth:500},square:!0,children:[e(ye,{title:d,subheader:`ID пользователя: ${u}`}),o!=null&&o!=""&&e(Qe,{component:"img",height:"240",image:o}),t(me,{children:[t(L,{variant:"body2",color:"text.secondary",children:["Адрес: ",c]}),e(L,{variant:"body2",color:"text.secondary",children:l})]}),t(be,{children:[e(ee,{size:"small",variant:"contained",onClick:()=>{window.open(a,"_blank")},children:"ССЫЛКА"}),t(D,{children:[e(ee,{color:"success",size:"small",variant:"contained",loading:m,onClick:()=>{x()},children:"Принять"}),e(ee,{color:"error",size:"small",variant:"contained",loading:m,onClick:()=>{s()},children:"Отклонить"})]})]})]})})}nt.propTypes={name:h.string.isRequired,id:h.string.isRequired,address:h.any,description:h.string.isRequired,link:h.string.isRequired,imagePath:h.string,userID:h.string};const tn=[["Comments","/admin/comments"],["Users","/admin/user-control"],["Institutions","/admin/institution-control"],["Requests","/admin/request-institution-control"]],nn=[["Main","/admin"],["Settings","/admin/settings"],["Home","/"]],rn=["/admin/comments","/admin/user-control","/admin/institution-control","/admin/request-institution-control"],an=["/admin","/admin/settings","/"];function sn(){const[n,d]=i.useState(0),[c,l]=i.useState(0),a=X(),u=re()();function m(){R.get(`${C.baseURL}/config/`).then(s=>{s.data.err?f.custom.error(s.data.err):s.data.admins.includes(u._id)||a("/")})}function b(s,r){return s==r?{backgroundColor:v[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}function x(s,r){return s==r?{backgroundColor:v[5],borderRadius:16,paddingLeft:12,paddingRight:12}:{}}return i.useEffect(()=>{m(),d(rn.indexOf(location.pathname)),l(an.indexOf(location.pathname))},[]),t(D,{children:[e("div",{className:"fixed top-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:v[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:tn.map((s,r)=>e("button",{onClick:()=>{a(s[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:b(r,n),children:[r==0&&e(je,{}),r==1&&e(Ve,{}),r==2&&e(Ne,{}),r==3&&e(vt,{})]}),e("label",{children:s[0]})]})},r))})}),e("div",{className:"fixed bottom-0 left-0 right-0 w-scree z-50",style:{height:76,backgroundColor:v[3]},children:e("div",{className:"flex flex-row items-center justify-around h-full",children:nn.map((s,r)=>e("button",{onClick:()=>{a(s[1])},children:t("div",{className:"flex flex-col justify-center items-center",children:[t("div",{style:x(r,c),children:[r==0&&e(Oe,{}),r==1&&e(Ct,{}),r==2&&e(It,{})]}),e("label",{children:s[0]})]})},r))})})]})}function se(n){return t(D,{children:[e(xe,{}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(sn,{}),e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"100vh",width:"100%",flexWrap:"wrap"},children:n.children})]})]})}const ln=G.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
`,on=G.div`
display:flex;
justify-content: center;
align-items: center;
margin: 10px;
width: fit-content;
`;function dn(){const n=ae(),d=X(),[c,l]=i.useState([]);async function a(){R.post(`${C.baseURL}/institutions/request/find`,{query:{}}).then(o=>{o.data.err?f.custom.error(o.data.err):l(o.data)})}return i.useEffect(()=>{n()?a():d("/login")},[]),e(se,{children:e(ln,{children:c.map(({_id:o,title:u,address:m,description:b,link:x,imagePath:s,userRequestID:r},y)=>e(on,{children:e(nt,{id:o,name:u,address:m,description:b,link:x,imagePath:s,userID:r})},y))})})}const cn=te(n=>{const{expand:d,...c}=n;return e(ue,{...c})})(({theme:n,expand:d})=>({transform:d?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})})),un=["Алматы","Астана","Шымкент"];function mn(n){const{open:d,institutionID:c,institutionTitle:l}=n,[a,o]=i.useState(""),[u,m]=i.useState(""),[b,x]=i.useState(""),[s,r]=i.useState(""),[y,S]=i.useState(""),[g,_]=i.useState(""),[U,k]=i.useState(!0);function P(){R.post(`${C.baseURL}/institutions/find`,{query:{_id:c}}).then(N=>{if(N.data.err)f.custom.error(N.data.err);else{const w=N.data[0];o(w.title),m(w.description),r(w.address),S(w.link),_(w.imagePath),x(w.city)}})}function p(N){N.preventDefault();const w=new FormData(N.currentTarget);R.post(`${C.baseURL}/institutions/edit`,{query:{_id:c},updated:{title:w.get("title"),description:w.get("description"),address:w.get("address"),link:w.get("link"),imagePath:w.get("imagePath")}}).then(T=>{T.data.err?f.custom.error(T.data.err):window.location.reload()})}function A(){document.getElementById("title").value=a,document.getElementById("description").value=u,document.getElementById("address").value=s,document.getElementById("link").value=y,document.getElementById("imagePath").value=g,document.getElementById("imagePath").value=b,k(!1)}return i.useEffect(()=>{P()},[]),t(Le,{open:d,children:[t(We,{children:["Реадактировать заведение ",l]}),e(D,{children:t(_e,{component:"form",noValidate:!0,onSubmit:p,sx:{margin:1},children:[e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"title",label:"Название заведения",name:"title"}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"description",label:"Описание",id:"description"}),e(De,{options:un,onInputChange:(N,w)=>{x(w)},className:"mt-3 w-full rounded-3xl",renderInput:N=>e(q,{variant:"outlined",...N,label:"Город",id:"city"})}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"address",label:"Адрес",id:"address"}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"link",label:"Ссылка",id:"link"}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"imagePath",label:"Путь к картинке",id:"imagePath"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(W,{type:"submit",color:"success",fullWidth:!0,variant:"contained",sx:{mt:2,mb:2,mr:1},disabled:U,children:"Сохранить"}),e(W,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{A()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})})]})}function hn({userID:n,rate:d,comment:c}){const[l,a]=i.useState("");function o(){const u={query:{_id:n}};R.post(`${C.baseURL}/users/find`,u).then(m=>{m.data.err?f.custom.error(res.data.err):a(m.data.login)})}return i.useEffect(()=>{o()},[]),t(D,{children:[e(J,{alignItems:"flex-start",children:e(Y,{primary:l+` - ${d}`,secondary:e(Z.Fragment,{children:c})})}),e(ze,{})]})}function it({comments:n,expanded:d,id:c}){return e(St,{in:d,timeout:"auto",unmountOnExit:!0,children:t(me,{children:[e(L,{paragraph:!0,children:"Comments:"}),e($e,{sx:{width:"100%",maxWidth:"500px"},children:n.map(({rate:l,userID:a,institutionID:o,content:u},m)=>o==c&&e(hn,{userID:a,rate:l,comment:u},m))})]})})}function rt({userID:n,id:d,name:c,address:l,description:a,link:o,imagePath:u}){n==null&&(localStorage.removeItem("token"),location.reload());const[m,b]=i.useState(""),[x,s]=i.useState(""),[r,y]=i.useState([]),[S,g]=i.useState(!1),[_,U]=i.useState(!1),k=()=>{g(!S)};function P(){R.post(`${C.baseURL}/institutions/remove`,{query:{_id:d}}).then(w=>{w.data.err?f.custom.error(w.data.err):window.location.reload()})}function p(){U(!0)}function A(){U(!1)}function N(){R.post(`${C.baseURL}/comments/get`,{query:{institutionID:d}}).then(w=>{if(w.data.err)f.custom.error(w.data.err);else{let T=w.data;y(T);let F=0,K=0;for(let z=0;z<T.length;z++){let ne=T[z].rate;F=F+parseInt(ne),K++}let $=Math.ceil(F/K*10)/10;$>0||($=5),$>=8?(b($.toString()),s(ce[800])):$>=6?(b($.toString()),s(ce[400])):$>=4?(b($.toString()),s(we[800])):$>=2?(b($.toString()),s(de[300])):$>=0?(b($.toString()),s(de[800])):(b("X"),s(Fe[50]))}})}return i.useEffect(()=>{N()},[]),t(pe,{sx:{width:"95vw",maxWidth:"500px",marginBottom:-1.1},children:[e(mn,{open:_,onClose:A,institutionID:d,institutionTitle:c}),e(ye,{title:c,subheader:`ID пользователя: ${n}`,avatar:t(ie,{sx:{bgcolor:x},"aria-label":"recipe",children:[" ",m," "]})}),u!=null&&u!=""&&e(Qe,{component:"img",height:"240",image:u}),t(me,{children:[t(L,{variant:"body2",color:"text.secondary",children:["Адрес: ",l]}),e(L,{variant:"body2",color:"text.secondary",children:a})]}),t(be,{disableSpacing:!0,children:[e(W,{size:"small",onClick:()=>{window.open(o,"_blank")},children:"ССЫЛКА"}),e(W,{size:"small",onClick:()=>{P()},children:"УДАЛИТЬ"}),e(W,{size:"small",onClick:()=>{p()},children:"РЕАДАКТИРОВАТЬ"}),e(cn,{expand:S,onClick:k,"aria-expanded":S,"aria-label":"show more",children:e(Rt,{})})]}),e(it,{expanded:S,comments:r,id:d})]})}rt.propTypes={name:h.string.isRequired,id:h.string.isRequired,userID:h.string.isRequired,address:h.any,status:h.array.isRequired,description:h.string.isRequired,link:h.string.isRequired,imagePath:h.string};it.propTypes={expanded:h.bool.isRequired,comments:h.array.isRequired,id:h.string.isRequired};const fn=G.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
`,gn=G.div`
  display:flex;
  justify-content: center;
  align-items: center;
  margin: 10px;
  width: fit-content;
`,pn=te("div")(({theme:n})=>({marginTop:10,width:"95vw",maxWidth:500,position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:qe(n.palette.common.white,.15),"&:hover":{backgroundColor:qe(n.palette.common.white,.25)},[n.breakpoints.up("sm")]:{marginLeft:n.spacing(3),width:"auto"}})),yn=te("div")(({theme:n})=>({padding:n.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"})),bn=te(He)(({theme:n})=>({color:"inherit","& .MuiInputBase-input":{padding:n.spacing(1,1,1,1),paddingLeft:`calc(1em + ${n.spacing(4)})`,transition:n.transitions.create("width"),width:"100%"}}));function xn(){const n=ae(),d=X(),l=re()(),[a,o]=i.useState([]),[u,m]=i.useState(""),[b,x]=i.useState([]),s=b.includes(l._id);function r(g){m(g.target.value)}async function y(){R.post(`${C.baseURL}/institutions/find`,{}).then(g=>{g.data.err?f.custom.error(g.data.err):o(g.data)})}async function S(){R.get(`${C.baseURL}/config/`).then(g=>{g.data.err?f.custom.error(g.data.err):x(g.data.admins)})}return i.useEffect(()=>{n()?(y(),S()):d("/login")},[]),e(se,{children:t("div",{className:"flex flex-col absolute top-20",children:[e("div",{style:{display:"flex",justifyContent:"center"},children:t(pn,{children:[e(yn,{children:e(Xe,{})}),e(bn,{placeholder:"Поиск...",inputProps:{"aria-label":"поиск"},onChange:r})]})}),e(fn,{children:a.map((g,_)=>g.title.includes(u)&&e(gn,{children:e(rt,{imagePath:g.imagePath,name:g.title,status:g.status,description:g.description,address:g.address,id:g._id,link:g.link,userID:l._id,isAdmin:s})},_))})]})})}function vn(){return e(se,{})}function at({id:n,login:d,inviteCode:c,acceptCode:l}){const[a,o]=i.useState(!1);function u(){R.post(`${C.baseURL}/users/remove`,{query:{id:n}}).then(m=>{m.data.err?f.custom.error(m.data.err):location.reload()})}return i.useEffect(()=>{o(!1)},[]),e(D,{children:t(pe,{sx:{width:"95vw",maxWidth:250},square:!0,children:[e(ye,{title:d}),t(me,{children:[t(L,{variant:"body2",color:"text.secondary",children:["ID: ",n]}),t(L,{variant:"body2",color:"text.secondary",children:["Invite Code: ",c]}),t(L,{variant:"body2",color:"text.secondary",children:["Accept Code: ",l]})]}),e(be,{children:e(ee,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:a,onClick:()=>{u()},children:"Удалить"})})]})})}at.propTypes={id:h.string.isRequired,login:h.string.isRequired,inviteCode:h.string.isRequired,acceptCode:h.string.isRequired};const Cn=G.div`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  width: 100%;
`,In=G.div`
display:flex;
justify-content: center;
align-items: center;
margin: 10px;
width: fit-content;
`;function Rn(){const[n,d]=i.useState([]);async function c(){R.post(`${C.baseURL}/users/find/all`).then(l=>{l.data.err?f.custom.error(l.data.err):d(l.data)})}return i.useEffect(()=>{c()},[]),e(se,{children:e(Cn,{children:n.map(({_id:l,login:a,inviteCode:o,acceptCode:u},m)=>l!=Et&&e(In,{children:e(at,{id:l,login:a,inviteCode:o,acceptCode:u})},m))})})}function Sn(){const[n,d]=i.useState(""),[c,l]=i.useState(""),[a,o]=i.useState([]),[u,m]=i.useState(!0);function b(){R.get(`${C.baseURL}/config/`).then(r=>{r.data.err?f.custom.error(r.data.err):(d(r.data.name),l(r.data.version),o(r.data.admins))})}function x(r){r.preventDefault();const y=new FormData(r.currentTarget);let S=y.get("admins").toString().split(",");S.includes("639f32ed1e7c8b26f1bceaac")||S.push("639f32ed1e7c8b26f1bceaac"),R.post(`${C.baseURL}/config/update`,{name:y.get("name"),version:y.get("version"),admins:S}).then(g=>{g.data.err?f.custom.error(g.data.err):location.reload()})}function s(){let r="";for(let y=0;y<a.length;y++)y==a.length-1?r+=a[y]:r+=a[y]+",";document.getElementById("name").value=n,document.getElementById("version").value=c,document.getElementById("admins").value=r,m(!1)}return i.useEffect(()=>{b()},[]),e(se,{children:t(_e,{component:"form",noValidate:!0,onSubmit:x,className:"p-4",children:[e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Имя проекта",name:"name"}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"version",label:"Версия",type:"version",id:"version"}),e(q,{InputLabelProps:{shrink:!0},margin:"normal",required:!0,fullWidth:!0,name:"admins",label:"Админы (перечислите ID пользователей через запятые без пробелов)",type:"admins",id:"admins"}),t("div",{style:{display:"flex",flexDirection:"row"},children:[e(W,{type:"submit",color:"success",fullWidth:!0,variant:"contained",size:"small",sx:{mt:2,mb:2},disabled:u,children:"Сохранить"}),e(W,{type:"button",fullWidth:!0,variant:"contained",onClick:()=>{s()},sx:{mt:2,mb:2,ml:1},children:"Загрузить текущие настройки..."})]})]})})}function st({commentID:n,userID:d,institutionID:c,text:l,rate:a}){const[o,u]=i.useState(!1),[m,b]=i.useState("");function x(){R.post(`${C.baseURL}/comments/remove`,{query:{_id:n}}).then(r=>{r.data.err?f.custom.error(r.data.err):window.location.reload()})}function s(){const r={query:{_id:d}};R.post(`${C.baseURL}/users/find`,r).then(y=>{y.data.err?f.custom.error(y.data.err):b(y.data.login)})}return i.useEffect(()=>{u(!1),s()},[]),e(D,{children:t(pe,{sx:{width:"95vw",maxWidth:250,margin:1},children:[e(ye,{title:m}),t(me,{children:[t(L,{variant:"body2",color:"text.secondary",children:["Rate: ",a]}),t(L,{variant:"body2",color:"text.secondary",children:["Comment ID: ",n]}),t(L,{variant:"body2",color:"text.secondary",children:["User ID: ",d]}),t(L,{variant:"body2",color:"text.secondary",children:["Institution ID: ",c]}),t(L,{variant:"body2",color:"text.secondary",children:["Comment Text: ",l]})]}),e(be,{children:e(ee,{color:"error",size:"small",variant:"contained",fullWidth:!0,loading:o,onClick:()=>{x()},children:"Удалить"})})]})})}st.propTypes={commentID:h.string.isRequired,userID:h.string.isRequired,institutionID:h.string.isRequired,text:h.string.isRequired};function wn(){const[n,d]=i.useState([]);function c(){R.post(`${C.baseURL}/comments/get`,{query:{}}).then(l=>{l.data.err?f.custom.error(l.data.err):d(l.data)})}return i.useEffect(()=>{c()},[]),e(se,{children:n.map((l,a)=>e(st,{commentID:l._id,userID:l.userID,institutionID:l.institutionID,text:l.content,rate:l.rate},a))})}function kn(){return e(Dt,{children:t(_t,{children:[e(j,{path:"/login",element:e(Ht,{})}),e(j,{path:"/register",element:e(Xt,{})}),e(j,{path:"/",element:e(M,{loginPath:"/login",children:e(Vt,{})})}),e(j,{path:"/request",element:e(M,{loginPath:"/login",children:e(en,{})})}),e(j,{path:"/settings",element:e(M,{loginPath:"/login",children:e(Qt,{})})}),e(j,{path:"/admin",element:e(M,{loginPath:"/login",children:e(vn,{})})}),e(j,{path:"/admin/institution-control",element:e(M,{loginPath:"/login",children:e(xn,{})})}),e(j,{path:"/admin/request-institution-control",element:e(M,{loginPath:"/login",children:e(dn,{})})}),e(j,{path:"/admin/user-control",element:e(M,{loginPath:"/login",children:e(Rn,{})})}),e(j,{path:"/admin/settings",element:e(M,{loginPath:"/login",children:e(Sn,{})})}),e(j,{path:"/admin/comments",element:e(M,{loginPath:"/login",children:e(wn,{})})})]})})}function qn(){return e(Ut,{authType:"localstorage",authName:"_auth",children:e(kn,{})})}const Nn=wt({palette:{mode:"dark",primary:{main:"#6750a4"},secondary:{main:"#625b71"}},shape:{borderRadius:15}});Pt.createRoot(document.getElementById("root")).render(e(i.StrictMode,{children:t(kt,{theme:Nn,children:[e(qt,{}),e(qn,{})]})}));
